rO0ABXNyABhleGNoYW5nZS5FeGNoYW5nZVBhY2thZ2WRpp24FfIsIQIABloABWRlYnVnTAAKYmFzZUZvbGRlcnQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAC2JpbmFyeUZpbGVzdAAVTGphdmEvdXRpbC9BcnJheUxpc3Q7TAAMaWdub3JlZEZpbGVzcQB+AAJMAA9zb3VyY2VDb2RlRmlsZXNxAH4AAkwABXRpdGxlcQB+AAF4cAF0AEEvbW50LzA2QjZDMjE1QjZDMjA1NjEvY29yZS9jb2RlL3JlcG9ydGVyL3J1bi9zYW5kYm94L3Rlc3Qtc2FtcGxlc3NyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAAEdwQAAAAKc3IAFHNwZHhsaWIuQ2hlY2tzdW1GaWxlBvOahJx76fsCAAhJAAttaW5TaXplVExTSEoABHNpemVMAANNRDVxAH4AAUwABFNIQTFxAH4AAUwABlNIQTI1NnEAfgABTAAEVExTSHEAfgABTAANZmlsZUV4dGVuc2lvbnEAfgABTAAIZmlsZW5hbWVxAH4AAXhyABZ0b2tlbml6YXRvci5CaW5hcnlGaWxlMYiL88J0MI8CAAVJAAptYXhNYXRjaGVzTAAEZmlsZXQADkxqYXZhL2lvL0ZpbGU7TAAOaWRlbnRpZmllckhhc2hxAH4AAUwAB21hdGNoZXNxAH4AAkwACXJlZmVyZW5jZXEAfgABeHAAAAADc3IADGphdmEuaW8uRmlsZQQtpEUODeT/AwABTAAEcGF0aHEAfgABeHB0ADdzYW5kYm94L3Rlc3Qtc2FtcGxlcy9hcGFjaGUvY29tbW9ucy9sYW5nL0NoYXJVdGlscy5qYXZhdwIAL3h0AChhZTQwNzIxZTdmYWM1MmYxZWVmMjZhODEzMWU1ZmIyNDAyOTFjYzI5c3EAfgAFAAAAAXcEAAAACnEAfgAKeHQAWGdpdGh1YjphZGJsb2NrcGx1cy1hZGJsb2NrcGx1c2FuZHJvaWQtZDkzZWU0OC9zcmMvb3JnL2FwYWNoZS9jb21tb25zL2xhbmcvQ2hhclV0aWxzLmphdmEAAEAAAAAAAAAAS4J0ACBkMjkzMjI4NTRmNDY3Y2M5MThmZmFkZWY0ODI3Y2E3OXQAKGFlNDA3MjFlN2ZhYzUyZjFlZWYyNmE4MTMxZTVmYjI0MDI5MWNjMjl0AEAxZjc1ODUwZjFjYWNiY2Y5MjJlOGI4Mzg5ZmFmY2MwMDdmM2IxNWFhOTdiMzZkOTJkMDU4ZDY4NzNlOWYwZGE2dABGMDdFMkJCQjZBREU3NjYzMzAyNDJEMTM4MDMxQkQwRDVEMjFFMUExRjkyNUJBQzkwNzg0QzdBQjBGRjQ5QjYyMTZBREZEQ3QABGphdmF0ACQuL2FwYWNoZS9jb21tb25zL2xhbmcvQ2hhclV0aWxzLmphdmFzcQB+AAcAAAADc3EAfgALdAA/c2FuZGJveC90ZXN0LXNhbXBsZXMvYXBhY2hlL2NvbW1vbnMvbGFuZy9TdHJpbmdFc2NhcGVVdGlscy5qYXZhdwIAL3h0ACgwMDYxNzk1OGIwNTdkOGFkZWYwN2I2NjcxMWJiNzI2YjA0OTRkMGEwc3EAfgAFAAAAAXcEAAAACnEAfgAXeHQAYGdpdGh1YjphZGJsb2NrcGx1cy1hZGJsb2NrcGx1c2FuZHJvaWQtZDkzZWU0OC9zcmMvb3JnL2FwYWNoZS9jb21tb25zL2xhbmcvU3RyaW5nRXNjYXBlVXRpbHMuamF2YQAAQAAAAAAAAABZwXQAIDYxMTc1NzhkYWE1MDQzMGI0ZTE2OTkxNzRiZDMzYzI3dAAoMDA2MTc5NThiMDU3ZDhhZGVmMDdiNjY3MTFiYjcyNmIwNDk0ZDBhMHQAQGFlN2RhMWQzOGIxZDAyOGZmNWU0NGUxNTU5NWFlYWM5YzI3N2M1NTFiNWQ5YjIzMWYyMjM0NjJjOTViYzViZjV0AEYwM0UyRTA1OUFDRTMxMzQyMTI5MkUxNzg0MzVGRDBBMUU2NUZEMjFGQTMzNTlGRTRCRDBDODc2MEFGNDY2MkMwNkJERUFEdAAEamF2YXQALC4vYXBhY2hlL2NvbW1vbnMvbGFuZy9TdHJpbmdFc2NhcGVVdGlscy5qYXZhc3EAfgAHAAAAA3NxAH4AC3QAOXNhbmRib3gvdGVzdC1zYW1wbGVzL2FwYWNoZS9jb21tb25zL2xhbmcvU3RyaW5nVXRpbHMuamF2YXcCAC94dAAoZDMzN2M5NGQyMjYwZjMxNWU2MjE0MDUyOTM0OTM4ODEwMDExNDM0MnNxAH4ABQAAAAF3BAAAAApxAH4AI3h0AFpnaXRodWI6YWRibG9ja3BsdXMtYWRibG9ja3BsdXNhbmRyb2lkLWQ5M2VlNDgvc3JjL29yZy9hcGFjaGUvY29tbW9ucy9sYW5nL1N0cmluZ1V0aWxzLmphdmEAAEAAAAAAAAACxfB0ACBmNWVjMzQwMGFlZGUxNGU1MGVkYzk1NGMyNTgwZGJlMHQAKGQzMzdjOTRkMjI2MGYzMTVlNjIxNDA1MjkzNDkzODgxMDAxMTQzNDJ0AEAyMWQ1OWFlZWRlZDQ4ZWMyOTg4ZjQyZjRiZDIxNTllNGIyMjk2OWE4NWZjNjdjMmZiY2ZmODgxZDczOTFmNjg3dABGOTgxNEVDMTY3Q0U2MEEyMTA2NTZEMDdBNEE0OTkwRDBFMjFFOTUyRkNCM0FGQ0Y0RkM0RDFGNzQyRjA5Qjc1OEFCREI4OXQABGphdmF0ACYuL2FwYWNoZS9jb21tb25zL2xhbmcvU3RyaW5nVXRpbHMuamF2YXNxAH4ABwAAAANzcQB+AAt0ACVzYW5kYm94L3Rlc3Qtc2FtcGxlcy9maWxlc19taW5vci5qYXZhdwIAL3h0ACg5YjNhMjJkZDUyNGU1MGVkODRlYzU5MTQ3YmU4MDEyOTg3MTYxODZjc3EAfgAFAAAAAHcEAAAACnhwAABAAAAAAAAAABSXdAAgOWM5MmFmOTA3NjkxOTA5OWQ4NDFmMjBiNjhlNzc0OGJxAH4AMnQAQGE1MGU4M2VkN2VhNzMyMDMxYjFmYzg4ZjQzNzQ1OTE2ZTU1NGJkMjA2OTY2YzJkOGY0NDQzNGYzZDgzY2Q5NTR0AEY1MTcyNjMyNjY5OUE3MThCRTY2M0IxQjk4NzRGNjE1M0YzNzY4ODMzNTMyQ0U5QjFGODFEQTcxNDJGMDAxMTQyN0YwQkU2dAAEamF2YXQAEi4vZmlsZXNfbWlub3IuamF2YXhzcQB+AAUAAAAAdwQAAAAKeHNxAH4ABQAAAAR3BAAAAApzcgAadG9rZW5pemF0b3IuU291cmNlQ29kZUZpbGWpRxZFu0MXoAIAAUwAGHNuaXBwZXRzSW5zaWRlU291cmNlQ29kZXEAfgACeHEAfgAIAAAAA3EAfgAMcQB+ABJzcQB+AAUAAAABdwQAAAAKcQB+AAp4cHNxAH4ABQAAAAF3BAAAABlzcgAddG9rZW5pemF0b3IuU291cmNlQ29kZVNuaXBwZXTx2d4nvbqnoAIACEkAB2xpbmVFbmRJAAlsaW5lU3RhcnRJAAxtYXRjaGVzTGltaXRMAA5pZGVudGlmaWVySGFzaHEAfgABTAAHbWF0Y2hlc3EAfgACTAAKcHJvdmVuYW5jZXEAfgABTAAEdGV4dHEAfgABWwAGdG9rZW5zdAACW0N4cAAAAYIAAAF5AAAABXEAfgASc3EAfgAFAAAAAHcEAAAACnhwdAE9CiAgICAgICAgaWYgKGNoIDwgMHgxMCkgewogICAgICAgICAgICByZXR1cm4gIlxcdTAwMCIgKyBJbnRlZ2VyLnRvSGV4U3RyaW5nKGNoKTsKICAgICAgICB9IGVsc2UgaWYgKGNoIDwgMHgxMDApIHsKICAgICAgICAgICAgcmV0dXJuICJcXHUwMCIgKyBJbnRlZ2VyLnRvSGV4U3RyaW5nKGNoKTsKICAgICAgICB9IGVsc2UgaWYgKGNoIDwgMHgxMDAwKSB7CiAgICAgICAgICAgIHJldHVybiAiXFx1MCIgKyBJbnRlZ2VyLnRvSGV4U3RyaW5nKGNoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICJcXHUiICsgSW50ZWdlci50b0hleFN0cmluZyhjaCk7CiAgICB1cgACW0OwJmaw4l2ErAIAAHhwAAAARwBJAEYAKABWADwAVgApAHsAUgAjACMAKwBWAE0AKABWACkAOwB9AEUATABJAEYAKABWADwAVgApAHsAUgAjACMAKwBWAE0AKABWACkAOwB9AEUATABJAEYAKABWADwAVgApAHsAUgAjACMAKwBWAE0AKABWACkAOwB9AFIAIwAjACsAVgBNACgAVgApADt4c3EAfgA7AAAAA3EAfgAYcQB+AB5zcQB+AAUAAAABdwQAAAAKcQB+ABd4cHNxAH4ABQAAAAh3BAAAABlzcQB+AD8AAACoAAAAmwAAAAVxAH4AHnNxAH4ABQAAAAB3BAAAAAp4cHQBdwogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgU3RyaW5nV3JpdGVyIHdyaXRlciA9IG5ldyBTdHJpbmdXcml0ZXIoc3RyLmxlbmd0aCgpICogMik7CiAgICAgICAgICAgIGVzY2FwZUphdmFTdHlsZVN0cmluZyh3cml0ZXIsIHN0ciwgZXNjYXBlU2luZ2xlUXVvdGVzKTsKICAgICAgICAgICAgcmV0dXJuIHdyaXRlci50b1N0cmluZygpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpb2UucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIHVxAH4ARAAAAEsASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0AVABSAHsATQBWAD0ATgBNACgAVgBNACgAKQAqAFYAKQA7AE0AKABWACwAVgAsAFYAKQA7AFIAVgBNACgAKQA7AH0AQwBBACgASQBPAEUAeABjAGUAcAB0AGkAbwBuAFYAKQB7AFYATQAoACkAOwBSAE4AVQA7AH1zcQB+AD8AAAD9AAAAsgAAAAVxAH4AHnNxAH4ABQAAAAB3BAAAAAp4cHQJnwogICAgICAgIGlmIChvdXQgPT0gbnVsbCkgewogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJUaGUgV3JpdGVyIG11c3Qgbm90IGJlIG51bGwiKTsKICAgICAgICB9CiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaW50IHN6OwogICAgICAgIHN6ID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3o7IGkrKykgewogICAgICAgICAgICBjaGFyIGNoID0gc3RyLmNoYXJBdChpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaCA+IDB4ZmZmKSB7CiAgICAgICAgICAgICAgICBvdXQud3JpdGUoIlxcdSIgKyBoZXgoY2gpKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjaCA+IDB4ZmYpIHsKICAgICAgICAgICAgICAgIG91dC53cml0ZSgiXFx1MCIgKyBoZXgoY2gpKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjaCA+IDB4N2YpIHsKICAgICAgICAgICAgICAgIG91dC53cml0ZSgiXFx1MDAiICsgaGV4KGNoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2ggPCAzMikgewogICAgICAgICAgICAgICAgc3dpdGNoIChjaCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ1xiJzoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCdcXCcpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJ2InKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnXG4nOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJ1xcJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnbicpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdcdCc6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXFwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCd0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ1xmJzoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCdcXCcpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJ2YnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnXHInOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJ1xcJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgncicpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0IDoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoID4gMHhmKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoIlxcdTAwIiArIGhleChjaCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCJcXHUwMDAiICsgaGV4KGNoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnXCcnOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXNjYXBlU2luZ2xlUXVvdGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJ1xcJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCdcJycpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICciJzoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCdcXCcpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJyInKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnXFwnOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJ1xcJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXFwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnLyc6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXFwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCcvJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQgOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoY2gpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIHVxAH4ARAAAAdkASQBGACgAVgA9AD0ATgBVACkAewBUAEgATgBNACgAIwAjACkAOwB9AEkARgAoAFYAPQA9AE4AVQApAHsAUgA7AH0ASQBWADsAVgA9AFYATQAoACkAOwBGAE8AKABWAG4AdABWAD0AVgA7AFYAPABWADsAVgArACsAKQB7AFYAYQByAFYAPQBWAC4AVgBhAHIAQQB0ACgAVgApADsASQBGACgAVgA+AFYAKQB7AFYATQAoACMAIwArAE0AKABWACkAKQA7AH0ARQBMAEkARgAoAFYAPgBWACkAewBWAE0AKAAjACMAKwBNACgAVgApACkAOwB9AEUATABJAEYAKABWAD4AVgApAHsAVgBNACgAIwAjACsATQAoAFYAKQApADsAfQBFAEwASQBGACgAVgA8AFYAKQB7AHMAdwBpAHQAVgAoAFYAKQB7AEMAUwAnAFwAYgAnADoAVgBNACgAJwBcAFwAJwApADsAVgBNACgAJwBiACcAKQA7AFYAOwBDAFMAJwBcAG4AJwA6AFYATQAoACcAXABcACcAKQA7AFYATQAoACcAbgAnACkAOwBWADsAQwBTACcAXAB0ACcAOgBWAE0AKAAnAFwAXAAnACkAOwBWAE0AKAAnAHQAJwApADsAVgA7AEMAUwAnAFwAZgAnADoAVgBNACgAJwBcAFwAJwApADsAVgBNACgAJwBmACcAKQA7AFYAOwBDAFMAJwBcAHIAJwA6AFYATQAoACcAXABcACcAKQA7AFYATQAoACcAcgAnACkAOwBWADsAVgA6AEkARgAoAFYAPgBWACkAewBWAE0AKAAjACMAKwBNACgAVgApACkAOwB9AEUATAB7AFYATQAoACMAIwArAE0AKABWACkAKQA7AH0AVgA7AH0AfQBFAEwAewBzAHcAaQB0AFYAKABWACkAewBDAFMAJwBcACcAJwA6AEkARgAoAFYAKQB7AFYATQAoACcAXABcACcAKQA7AH0AVgBNACgAJwBcACcAJwApADsAVgA7AEMAUwAnACIAJwA6AFYATQAoACcAXABcACcAKQA7AFYATQAoACcAIgAnACkAOwBWADsAQwBTACcAXABcACcAOgBWAE0AKAAnAFwAXAAnACkAOwBWAE0AKAAnAFwAXAAnACkAOwBWADsAQwBTACcALwAnADoAVgBNACgAJwBcAFwAJwApADsAVgBNACgAJwAvACcAKQA7AFYAOwBWADoAVgBNACgAVgApADsAVgA7AH0AfQB9c3EAfgA/AAABIAAAARMAAAAFcQB+AB5zcQB+AAUAAAAAdwQAAAAKeHB0AVYKICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN0cmluZ1dyaXRlciB3cml0ZXIgPSBuZXcgU3RyaW5nV3JpdGVyKHN0ci5sZW5ndGgoKSk7CiAgICAgICAgICAgIHVuZXNjYXBlSmF2YSh3cml0ZXIsIHN0cik7CiAgICAgICAgICAgIHJldHVybiB3cml0ZXIudG9TdHJpbmcoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW9lLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB1cQB+AEQAAABHAEkARgAoAFYAPQA9AE4AVQApAHsAUgBOAFUAOwB9AFQAUgB7AE0AVgA9AE4ATQAoAFYATQAoACkAKQA7AE0AKABWACwAVgApADsAUgBWAE0AKAApADsAfQBDAEEAKABJAE8ARQB4AGMAZQBwAHQAaQBvAG4AVgApAHsAVgBNACgAKQA7AFIATgBVADsAfXNxAH4APwAAAYMAAAExAAAABXEAfgAec3EAfgAFAAAAAHcEAAAACnhwdApCCiAgICAgICAgaWYgKG91dCA9PSBudWxsKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIlRoZSBXcml0ZXIgbXVzdCBub3QgYmUgbnVsbCIpOwogICAgICAgIH0KICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpbnQgc3ogPSBzdHIubGVuZ3RoKCk7CiAgICAgICAgU3RyaW5nQnVmZmVyIHVuaWNvZGUgPSBuZXcgU3RyaW5nQnVmZmVyKDQpOwogICAgICAgIGJvb2xlYW4gaGFkU2xhc2ggPSBmYWxzZTsKICAgICAgICBib29sZWFuIGluVW5pY29kZSA9IGZhbHNlOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3o7IGkrKykgewogICAgICAgICAgICBjaGFyIGNoID0gc3RyLmNoYXJBdChpKTsKICAgICAgICAgICAgaWYgKGluVW5pY29kZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmljb2RlLmFwcGVuZChjaCk7CiAgICAgICAgICAgICAgICBpZiAodW5pY29kZS5sZW5ndGgoKSA9PSA0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludCB2YWx1ZSA9IEludGVnZXIucGFyc2VJbnQodW5pY29kZS50b1N0cmluZygpLCAxNik7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgoY2hhcikgdmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICB1bmljb2RlLnNldExlbmd0aCgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgaW5Vbmljb2RlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIGhhZFNsYXNoID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIG5mZSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAoSU9FeGNlcHRpb24pIG5ldyBJT0V4Y2VwdGlvbigiVW5hYmxlIHRvIHBhcnNlIHVuaWNvZGUgdmFsdWU6ICIgKyB1bmljb2RlKS5pbml0Q2F1c2UobmZlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaGFkU2xhc2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYWRTbGFzaCA9IGZhbHNlOwogICAgICAgICAgICAgICAgc3dpdGNoIChjaCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ1xcJzoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCdcXCcpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdcJyc6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXCcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnXCInOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoJyInKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAncic6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXHInKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZic6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXGYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAndCc6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXHQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbic6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXG4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYic6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgnXGInKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAndSc6CiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpblVuaWNvZGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0IDoKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKGNoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjaCA9PSAnXFwnKSB7CiAgICAgICAgICAgICAgICBoYWRTbGFzaCA9IHRydWU7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBvdXQud3JpdGUoY2gpOwogICAgICAgIH0KICAgICAgICBpZiAoaGFkU2xhc2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0LndyaXRlKCdcXCcpOwogICAgICAgIH0KICAgIHVxAH4ARAAAAbwASQBGACgAVgA9AD0ATgBVACkAewBUAEgATgBNACgAIwAjACkAOwB9AEkARgAoAFYAPQA9AE4AVQApAHsAUgA7AH0ASQBWAD0AVgBNACgAKQA7AE0AVgA9AE4ATQAoAFYAKQA7AEIATwBWAD0ARgA7AEIATwBWAD0ARgA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBhAHIAVgA9AFYALgBWAGEAcgBBAHQAKABWACkAOwBJAEYAKABWACkAewBWAE0AKABWACkAOwBJAEYAKABWAE0AKAApAD0APQBWACkAewBUAFIAewBJAFYAPQBWAE0AKABWAE0AKAApACwAVgApADsAVgBNACgAKABWACkAVgApADsAVgBNACgAVgApADsAVgA9AEYAOwBWAD0ARgA7AH0AQwBBACgATgB1AG0AYgBlAHIARgBvAHIAbQBhAHQARQB4AGMAZQBwAHQAaQBvAG4AVgApAHsAVABIACgAVgApAE4AVgAoACMAIwArAFYAKQAuAE0AKABWACkAOwB9AH0AVgA7AH0ASQBGACgAVgApAHsAVgA9AEYAOwBzAHcAaQB0AFYAKABWACkAewBDAFMAJwBcAFwAJwA6AFYATQAoACcAXABcACcAKQA7AFYAOwBDAFMAJwBcACcAJwA6AFYATQAoACcAXAAnACcAKQA7AFYAOwBDAFMAJwBcACIAJwA6AFYATQAoACcAIgAnACkAOwBWADsAQwBTACcAcgAnADoAVgBNACgAJwBcAHIAJwApADsAVgA7AEMAUwAnAGYAJwA6AFYATQAoACcAXABmACcAKQA7AFYAOwBDAFMAJwB0ACcAOgBWAE0AKAAnAFwAdAAnACkAOwBWADsAQwBTACcAbgAnADoAVgBNACgAJwBcAG4AJwApADsAVgA7AEMAUwAnAGIAJwA6AFYATQAoACcAXABiACcAKQA7AFYAOwBDAFMAJwB1ACcAOgB7AFYAPQBUAEUAOwBWADsAfQBWADoAVgBNACgAVgApADsAVgA7AH0AVgA7AH0ARQBMAEkARgAoAFYAPQA9ACcAXABcACcAKQB7AFYAPQBUAEUAOwBWADsAfQBWAE0AKABWACkAOwB9AEkARgAoAFYAKQB7AFYATQAoACcAXABcACcAKQA7AH1zcQB+AD8AAAHnAAAB2gAAAAVxAH4AHnNxAH4ABQAAAAB3BAAAAAp4cHQBagogICAgICAgIGlmIChTdHJpbmdVdGlscy5jb250YWluc05vbmUoc3RyLCBDU1ZfU0VBUkNIX0NIQVJTKSkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmdXcml0ZXIgd3JpdGVyID0gbmV3IFN0cmluZ1dyaXRlcigpOwogICAgICAgICAgICBlc2NhcGVDc3Yod3JpdGVyLCBzdHIpOwogICAgICAgICAgICByZXR1cm4gd3JpdGVyLnRvU3RyaW5nKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlvZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgdXEAfgBEAAAARABJAEYAKABWAE0AKABWACwAVgApACkAewBSAFYAOwB9AFQAUgB7AE0AVgA9AE4ATQAoACkAOwBNACgAVgAsAFYAKQA7AFIAVgBNACgAKQA7AH0AQwBBACgASQBPAEUAeABjAGUAcAB0AGkAbwBuAFYAKQB7AFYATQAoACkAOwBSAE4AVQA7AH1zcQB+AD8AAAIQAAACAAAAAAVxAH4AHnNxAH4ABQAAAAB3BAAAAAp4cHQBugogICAgICAgIGlmIChTdHJpbmdVdGlscy5jb250YWluc05vbmUoc3RyLCBDU1ZfU0VBUkNIX0NIQVJTKSkgewogICAgICAgICAgICBpZiAoc3RyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIG91dC53cml0ZShzdHIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgb3V0LndyaXRlKENTVl9RVU9URSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoKCk7IGkrKykgewogICAgICAgICAgICBjaGFyIGMgPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICBpZiAoYyA9PSBDU1ZfUVVPVEUpIHsKICAgICAgICAgICAgICAgIG91dC53cml0ZShDU1ZfUVVPVEUpOyAgICAgICAgICAgICB9CiAgICAgICAgICAgIG91dC53cml0ZShjKTsKICAgICAgICB9CiAgICAgICAgb3V0LndyaXRlKENTVl9RVU9URSk7CiAgICB1cQB+AEQAAABrAEkARgAoAFYATQAoAFYALABWACkAKQB7AEkARgAoAFYAIQA9AE4AVQApAHsAVgBNACgAVgApADsAfQBSADsAfQBWAE0AKABWACkAOwBGAE8AKABWAG4AdABWAD0AVgA7AFYAPABWAE0AKAApADsAVgArACsAKQB7AFYAaABhAHIAVgA9AFYALgBWAGgAYQByAEEAdAAoAFYAKQA7AEkARgAoAFYAPQA9AFYAKQB7AFYATQAoAFYAKQA7AH0AVgBNACgAVgApADsAfQBWAE0AKABWACkAO3NxAH4APwAAAjUAAAIoAAAABXEAfgAec3EAfgAFAAAAAHcEAAAACnhwdAFJCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmdXcml0ZXIgd3JpdGVyID0gbmV3IFN0cmluZ1dyaXRlcigpOwogICAgICAgICAgICB1bmVzY2FwZUNzdih3cml0ZXIsIHN0cik7CiAgICAgICAgICAgIHJldHVybiB3cml0ZXIudG9TdHJpbmcoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW9lLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB1cQB+AEQAAABDAEkARgAoAFYAPQA9AE4AVQApAHsAUgBOAFUAOwB9AFQAUgB7AE0AVgA9AE4ATQAoACkAOwBNACgAVgAsAFYAKQA7AFIAVgBNACgAKQA7AH0AQwBBACgASQBPAEUAeABjAGUAcAB0AGkAbwBuAFYAKQB7AFYATQAoACkAOwBSAE4AVQA7AH1zcQB+AD8AAAJkAAACTgAAAAVxAH4AHnNxAH4ABQAAAAB3BAAAAAp4cHQCSQogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzdHIubGVuZ3RoKCkgPCAyKSB7CiAgICAgICAgICAgIG91dC53cml0ZShzdHIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICggc3RyLmNoYXJBdCgwKSAhPSBDU1ZfUVVPVEUgfHwgc3RyLmNoYXJBdChzdHIubGVuZ3RoKCkgLSAxKSAhPSBDU1ZfUVVPVEUgKSB7CiAgICAgICAgICAgIG91dC53cml0ZShzdHIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAgICAgICAgIFN0cmluZyBxdW90ZWxlc3MgPSBzdHIuc3Vic3RyaW5nKDEsIHN0ci5sZW5ndGgoKSAtIDEpOwoKICAgICAgICBpZiAoIFN0cmluZ1V0aWxzLmNvbnRhaW5zQW55KHF1b3RlbGVzcywgQ1NWX1NFQVJDSF9DSEFSUykgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciA9IFN0cmluZ1V0aWxzLnJlcGxhY2UocXVvdGVsZXNzLCBDU1ZfUVVPVEVfU1RSICsgQ1NWX1FVT1RFX1NUUiwgQ1NWX1FVT1RFX1NUUik7CiAgICAgICAgfQoKICAgICAgICBvdXQud3JpdGUoc3RyKTsKICAgIHVxAH4ARAAAAH4ASQBGACgAVgA9AD0ATgBVACkAewBSADsAfQBJAEYAKABWAE0AKAApADwAVgApAHsAVgBNACgAVgApADsAUgA7AH0ASQBGACgAVgBNACgAVgApACEAPQBWAHwAfABWAE0AKABWAE0AKAApAC0AVgApACEAPQBWACkAewBWAE0AKABWACkAOwBSADsAfQBTAFYAPQBWAC4AcwB1AGIAVgBpAG4AZwAoAFYALABWAE0AKAApAC0AVgApADsASQBGACgAVgBNACgAVgAsAFYAKQApAHsAVgA9AFYATQAoAFYALABWACsAVgAsAFYAKQA7AH0AVgBNACgAVgApADt4c3EAfgA7AAAAA3EAfgAkcQB+ACpzcQB+AAUAAAABdwQAAAAKcQB+ACN4cHNxAH4ABQAAADt3BAAAAIVzcQB+AD8AAADtAAAA4gAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBMQogICAgICAgIGludCBzdHJMZW47CiAgICAgICAgaWYgKHN0ciA9PSBudWxsIHx8IChzdHJMZW4gPSBzdHIubGVuZ3RoKCkpID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3RyTGVuOyBpKyspIHsKICAgICAgICAgICAgaWYgKChDaGFyYWN0ZXIuaXNXaGl0ZXNwYWNlKHN0ci5jaGFyQXQoaSkpID09IGZhbHNlKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgdXEAfgBEAAAAXQBJAFYAOwBJAEYAKABWAD0APQBOAFUAfAB8ACgAVgBMAGUAbgA9AFYATQAoACkAKQA9AD0AVgApAHsAUgBUAEUAOwB9AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAKABWAC4AVgBzAFcAaABWAHQAZQBzAHAAYQBjAGUAKABWAE0AKABWACkAKQA9AD0ARgApACkAewBSAEYAOwB9AH0AUgBUAEUAO3NxAH4APwAAAgwAAAH6AAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAIyCiAgICAgICAgaW50IHN0ckxlbjsKICAgICAgICBpZiAoc3RyID09IG51bGwgfHwgKHN0ckxlbiA9IHN0ci5sZW5ndGgoKSkgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICBpbnQgc3RhcnQgPSAwOwogICAgICAgIGlmIChzdHJpcENoYXJzID09IG51bGwpIHsKICAgICAgICAgICAgd2hpbGUgKChzdGFydCAhPSBzdHJMZW4pICYmIENoYXJhY3Rlci5pc1doaXRlc3BhY2Uoc3RyLmNoYXJBdChzdGFydCkpKSB7CiAgICAgICAgICAgICAgICBzdGFydCsrOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChzdHJpcENoYXJzLmxlbmd0aCgpID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB3aGlsZSAoKHN0YXJ0ICE9IHN0ckxlbikgJiYgKHN0cmlwQ2hhcnMuaW5kZXhPZihzdHIuY2hhckF0KHN0YXJ0KSkgIT0gLTEpKSB7CiAgICAgICAgICAgICAgICBzdGFydCsrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKHN0YXJ0KTsKICAgIHVxAH4ARAAAAI8ASQBWADsASQBGACgAVgA9AD0ATgBVAHwAfAAoAFYATABlAG4APQBWAE0AKAApACkAPQA9AFYAKQB7AFIAVgA7AH0ASQBWAD0AVgA7AEkARgAoAFYAPQA9AE4AVQApAHsAVwAoACgAVgAhAD0AVgApACYAJgBWAE0AKABWAE0AKABWACkAKQApAHsAVgArACsAOwB9AH0ARQBMAEkARgAoAFYATQAoACkAPQA9AFYAKQB7AFIAVgA7AH0ARQBMAHsAVwAoACgAVgAhAD0AVgApACYAJgAoAFYATQAoAFYATQAoAFYAKQApACEAPQAtAFYAKQApAHsAVgArACsAOwB9AH0AUgBWAC4AcwB1AGIAVgBpAG4AZwAoAFYAKQA7c3EAfgA/AAACOAAAAiYAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AgkKICAgICAgICBpbnQgZW5kOwogICAgICAgIGlmIChzdHIgPT0gbnVsbCB8fCAoZW5kID0gc3RyLmxlbmd0aCgpKSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBzdHI7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RyaXBDaGFycyA9PSBudWxsKSB7CiAgICAgICAgICAgIHdoaWxlICgoZW5kICE9IDApICYmIENoYXJhY3Rlci5pc1doaXRlc3BhY2Uoc3RyLmNoYXJBdChlbmQgLSAxKSkpIHsKICAgICAgICAgICAgICAgIGVuZC0tOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChzdHJpcENoYXJzLmxlbmd0aCgpID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB3aGlsZSAoKGVuZCAhPSAwKSAmJiAoc3RyaXBDaGFycy5pbmRleE9mKHN0ci5jaGFyQXQoZW5kIC0gMSkpICE9IC0xKSkgewogICAgICAgICAgICAgICAgZW5kLS07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgZW5kKTsKICAgIHVxAH4ARAAAAI0ASQBWADsASQBGACgAVgA9AD0ATgBVAHwAfAAoAFYAPQBWAE0AKAApACkAPQA9AFYAKQB7AFIAVgA7AH0ASQBGACgAVgA9AD0ATgBVACkAewBXACgAKABWACEAPQBWACkAJgAmAFYATQAoAFYATQAoAFYALQBWACkAKQApAHsAVgAtAC0AOwB9AH0ARQBMAEkARgAoAFYATQAoACkAPQA9AFYAKQB7AFIAVgA7AH0ARQBMAHsAVwAoACgAVgAhAD0AVgApACYAJgAoAFYATQAoAFYATQAoAFYALQBWACkAKQAhAD0ALQBWACkAKQB7AFYALQAtADsAfQB9AFIAVgAuAHMAdQBiAFYAaQBuAGcAKABWACwAVgApADtzcQB+AD8AAAJ2AAACbAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBKQogICAgICAgIGludCBzdHJzTGVuOwogICAgICAgIGlmIChzdHJzID09IG51bGwgfHwgKHN0cnNMZW4gPSBzdHJzLmxlbmd0aCkgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyczsKICAgICAgICB9CiAgICAgICAgU3RyaW5nW10gbmV3QXJyID0gbmV3IFN0cmluZ1tzdHJzTGVuXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN0cnNMZW47IGkrKykgewogICAgICAgICAgICBuZXdBcnJbaV0gPSBzdHJpcChzdHJzW2ldLCBzdHJpcENoYXJzKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ld0FycjsKICAgIHVxAH4ARAAAAFwASQBWADsASQBGACgAVgA9AD0ATgBVAHwAfAAoAFYATABlAG4APQBWAC4AbABlAG4AZwB0AGgAKQA9AD0AVgApAHsAUgBWADsAfQBWAFsAXQBWAD0ATgBWAFsAcwB0AHIAcwBMAGUAbgBdADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBWAFsAaQBdAD0ATQAoAFYAWwBpAF0ALABWACkAOwB9AFIAVgA7c3EAfgA/AAADMAAAAx8AAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AdEKICAgICAgICBpZiAoc3RyID09IG51bGwgfHwgc2VhcmNoU3RyID09IG51bGwgfHwgb3JkaW5hbCA8PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBJTkRFWF9OT1RfRk9VTkQ7CiAgICAgICAgfQogICAgICAgIGlmIChzZWFyY2hTdHIubGVuZ3RoKCkgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgaW50IGZvdW5kID0gMDsKICAgICAgICBpbnQgaW5kZXggPSBJTkRFWF9OT1RfRk9VTkQ7CiAgICAgICAgZG8gewogICAgICAgICAgICBpbmRleCA9IHN0ci5pbmRleE9mKHNlYXJjaFN0ciwgaW5kZXggKyAxKTsKICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvdW5kKys7CiAgICAgICAgfSB3aGlsZSAoZm91bmQgPCBvcmRpbmFsKTsKICAgICAgICByZXR1cm4gaW5kZXg7CiAgICB1cQB+AEQAAABiAEkARgAoAFYAPQA9AE4AVQB8AHwAVgA9AD0ATgBVAHwAfABWADwAPQBWACkAewBSAFYAOwB9AEkARgAoAFYATQAoACkAPQA9AFYAKQB7AFIAVgA7AH0ASQBWAD0AVgA7AEkAVgA9AFYAOwBEAE8AewBWAD0AVgAuAFYATwBmACgAVgAsAFYAKwBWACkAOwBJAEYAKABWADwAVgApAHsAUgBWADsAfQBWACsAKwA7AH0AVwAoAFYAPABWACkAOwBSAFYAO3NxAH4APwAABFYAAARJAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAGpCiAgICAgICAgaWYgKHN0ciA9PSBudWxsIHx8IHN0ci5sZW5ndGgoKSA9PSAwIHx8IHNlYXJjaENoYXJzID09IG51bGwgfHwgc2VhcmNoQ2hhcnMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN0ci5sZW5ndGgoKTsgaSsrKSB7CiAgICAgICAgICAgIGNoYXIgY2ggPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHNlYXJjaENoYXJzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICBpZiAoc2VhcmNoQ2hhcnNbal0gPT0gY2gpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB1cQB+AEQAAAByAEkARgAoAFYAPQA9AE4AVQB8AHwAVgBNACgAKQA9AD0AVgB8AHwAVgA9AD0ATgBVAHwAfABWAE0APQA9AFYAKQB7AFIARgA7AH0ARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgBNACgAKQA7AFYAKwArACkAewBWAGEAcgBWAD0AVgAuAFYAYQByAEEAdAAoAFYAKQA7AEYATwAoAEkAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBJAEYAKABWAFsAagBdAD0APQBWACkAewBSAFQARQA7AH0AfQB9AFIARgA7c3EAfgA/AAAEmgAABJAAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AQoKICAgICAgICBpZiAoaXNFbXB0eShzdHIpIHx8IGlzRW1wdHkoc2VhcmNoQ2hhcnMpKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoKCk7IGkrKykgewogICAgICAgICAgICBpZiAoc2VhcmNoQ2hhcnMuaW5kZXhPZihzdHIuY2hhckF0KGkpKSA8IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAtMTsKICAgIHVxAH4ARAAAAEoASQBGACgATQAoAFYAKQB8AHwATQAoAFYAKQApAHsAUgAtAFYAOwB9AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYATQAoACkAOwBWACsAKwApAHsAVgBmACgAVgAuAFYAbgBkAGUAeABPAGYAKABWAE0AKABWACkAKQA8AFYAKQB7AFIAVgA7AH0AfQBSAC0AVgA7c3EAfgA/AAAEwwAABLQAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0Ab0KICAgICAgICBpZiAoc3RyID09IG51bGwgfHwgaW52YWxpZENoYXJzID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGludCBzdHJTaXplID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGludCB2YWxpZFNpemUgPSBpbnZhbGlkQ2hhcnMubGVuZ3RoOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3RyU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIGNoYXIgY2ggPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHZhbGlkU2l6ZTsgaisrKSB7CiAgICAgICAgICAgICAgICBpZiAoaW52YWxpZENoYXJzW2pdID09IGNoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgdXEAfgBEAAAAcwBJAEYAKABWAD0APQBOAFUAfAB8AFYAPQA9AE4AVQApAHsAUgBUAEUAOwB9AEkAVgA9AFYATQAoACkAOwBJAFYAPQBWADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAcwB0AHIAUwBWAHoAZQA7AFYAKwArACkAewBWAGEAcgBWAD0AVgAuAFYAYQByAEEAdAAoAFYAKQA7AEYATwAoAEkAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBJAEYAKABWAFsAagBdAD0APQBWACkAewBSAEYAOwB9AH0AfQBSAFQARQA7c3EAfgA/AAAFGAAABP4AAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AlMKICAgICAgICBpZiAoKHN0ciA9PSBudWxsKSB8fCAoc2VhcmNoU3RycyA9PSBudWxsKSkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGludCBzeiA9IHNlYXJjaFN0cnMubGVuZ3RoOwoKICAgICAgICAgICAgICAgIGludCByZXQgPSBJbnRlZ2VyLk1BWF9WQUxVRTsKCiAgICAgICAgaW50IHRtcCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzejsgaSsrKSB7CiAgICAgICAgICAgIFN0cmluZyBzZWFyY2ggPSBzZWFyY2hTdHJzW2ldOwogICAgICAgICAgICBpZiAoc2VhcmNoID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRtcCA9IHN0ci5pbmRleE9mKHNlYXJjaCk7CiAgICAgICAgICAgIGlmICh0bXAgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodG1wIDwgcmV0KSB7CiAgICAgICAgICAgICAgICByZXQgPSB0bXA7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiAocmV0ID09IEludGVnZXIuTUFYX1ZBTFVFKSA/IC0xIDogcmV0OwogICAgdXEAfgBEAAAAiABJAEYAKAAoAFYAPQA9AE4AVQApAHwAfAAoAFYAPQA9AE4AVQApACkAewBSAC0AVgA7AH0ASQBWAD0AVgA7AEkAVgA9AFYAOwBJAFYAPQBWADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBTAFYAPQBWAFMAdAByAHMAWwBpAF0AOwBJAEYAKABWAD0APQBOAFUAKQB7AFYAOwB9AFYAPQBWAE0AKABWACkAOwBJAEYAKABWAD0APQAtAFYAKQB7AFYAOwB9AEkARgAoAFYAPABWACkAewBWAD0AVgA7AH0AfQBWAHUAcgBuACgAVgA9AD0AVgApAD8ALQBWADoAVgA7c3EAfgA/AAAFRQAABTMAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AdUKICAgICAgICBpZiAoKHN0ciA9PSBudWxsKSB8fCAoc2VhcmNoU3RycyA9PSBudWxsKSkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGludCBzeiA9IHNlYXJjaFN0cnMubGVuZ3RoOwogICAgICAgIGludCByZXQgPSAtMTsKICAgICAgICBpbnQgdG1wID0gMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN6OyBpKyspIHsKICAgICAgICAgICAgU3RyaW5nIHNlYXJjaCA9IHNlYXJjaFN0cnNbaV07CiAgICAgICAgICAgIGlmIChzZWFyY2ggPT0gbnVsbCkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdG1wID0gc3RyLmxhc3RJbmRleE9mKHNlYXJjaCk7CiAgICAgICAgICAgIGlmICh0bXAgPiByZXQpIHsKICAgICAgICAgICAgICAgIHJldCA9IHRtcDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0OwogICAgdXEAfgBEAAAAcgBJAEYAKAAoAFYAPQA9AE4AVQApAHwAfAAoAFYAPQA9AE4AVQApACkAewBSAC0AVgA7AH0ASQBWAD0AVgA7AEkAVgA9AC0AVgA7AEkAVgA9AFYAOwBGAE8AKABWAG4AdABWAD0AVgA7AFYAPABWADsAVgArACsAKQB7AFMAVgA9AFYAUwB0AHIAcwBbAGkAXQA7AEkARgAoAFYAPQA9AE4AVQApAHsAVgA7AH0AVgA9AFYATQAoAFYAKQA7AEkARgAoAFYAPgBWACkAewBWAD0AVgA7AH0AfQBWAHUAcgBuAFYAO3NxAH4APwAABXMAAAVhAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAFCCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPCAwKSB7CiAgICAgICAgICAgIHN0YXJ0ID0gc3RyLmxlbmd0aCgpICsgc3RhcnQ7ICAgICAgICAgfQoKICAgICAgICBpZiAoc3RhcnQgPCAwKSB7CiAgICAgICAgICAgIHN0YXJ0ID0gMDsKICAgICAgICB9CiAgICAgICAgaWYgKHN0YXJ0ID4gc3RyLmxlbmd0aCgpKSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKHN0YXJ0KTsKICAgIHVxAH4ARAAAAEsASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBGACgAVgA8AFYAKQB7AFYAPQBWAE0AKAApACsAVgA7AH0ASQBGACgAVgA8AFYAKQB7AFYAPQBWADsAfQBJAEYAKABWAD4AVgBNACgAKQApAHsAUgBWADsAfQBSAFYALgBzAHUAYgBWAGkAbgBnACgAVgApADtzcQB+AD8AAAW3AAAFmAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQCGQogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGVuZCA8IDApIHsKICAgICAgICAgICAgZW5kID0gc3RyLmxlbmd0aCgpICsgZW5kOyAgICAgICAgIH0KICAgICAgICBpZiAoc3RhcnQgPCAwKSB7CiAgICAgICAgICAgIHN0YXJ0ID0gc3RyLmxlbmd0aCgpICsgc3RhcnQ7ICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChlbmQgPiBzdHIubGVuZ3RoKCkpIHsKICAgICAgICAgICAgZW5kID0gc3RyLmxlbmd0aCgpOwogICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPiBlbmQpIHsKICAgICAgICAgICAgcmV0dXJuIEVNUFRZOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YXJ0IDwgMCkgewogICAgICAgICAgICBzdGFydCA9IDA7CiAgICAgICAgfQogICAgICAgIGlmIChlbmQgPCAwKSB7CiAgICAgICAgICAgIGVuZCA9IDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc3RyLnN1YnN0cmluZyhzdGFydCwgZW5kKTsKICAgIHVxAH4ARAAAAHwASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBGACgAVgA8AFYAKQB7AFYAPQBWAE0AKAApACsAVgA7AH0ASQBGACgAVgA8AFYAKQB7AFYAPQBWAE0AKAApACsAVgA7AH0ASQBGACgAVgA+AFYATQAoACkAKQB7AFYAPQBWAE0AKAApADsAfQBJAEYAKABWAD4AVgApAHsAUgBWADsAfQBJAEYAKABWADwAVgApAHsAVgA9AFYAOwB9AEkARgAoAFYAPABWACkAewBWAD0AVgA7AH0AUgBWAC4AcwB1AGIAVgBpAG4AZwAoAFYALABWACkAO3NxAH4APwAABdoAAAXPAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdADpCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAobGVuIDwgMCkgewogICAgICAgICAgICByZXR1cm4gRU1QVFk7CiAgICAgICAgfQogICAgICAgIGlmIChzdHIubGVuZ3RoKCkgPD0gbGVuKSB7CiAgICAgICAgICAgIHJldHVybiBzdHI7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIGxlbik7CiAgICB1cQB+AEQAAAA/AEkARgAoAFYAPQA9AE4AVQApAHsAUgBOAFUAOwB9AEkARgAoAFYAPABWACkAewBSAFYAOwB9AEkARgAoAFYALgBWAGcAdABoACgAKQA8AD0AVgApAHsAUgBWADsAfQBSAFYALgBzAHUAYgBWAGkAbgBnACgAVgAsAFYAKQA7c3EAfgA/AAAF+wAABfAAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0APUKICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gPCAwKSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWTsKICAgICAgICB9CiAgICAgICAgaWYgKHN0ci5sZW5ndGgoKSA8PSBsZW4pIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoc3RyLmxlbmd0aCgpIC0gbGVuKTsKICAgIHVxAH4ARAAAAEYASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBGACgAVgA8AFYAKQB7AFIAVgA7AH0ASQBGACgAVgAuAFYAZwB0AGgAKAApADwAPQBWACkAewBSAFYAOwB9AFIAVgAuAHMAdQBiAFYAaQBuAGcAKABWAC4AVgBnAHQAaAAoACkALQBWACkAO3NxAH4APwAABiMAAAYVAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAFUCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAobGVuIDwgMCB8fCBwb3MgPiBzdHIubGVuZ3RoKCkpIHsKICAgICAgICAgICAgcmV0dXJuIEVNUFRZOwogICAgICAgIH0KICAgICAgICBpZiAocG9zIDwgMCkgewogICAgICAgICAgICBwb3MgPSAwOwogICAgICAgIH0KICAgICAgICBpZiAoc3RyLmxlbmd0aCgpIDw9IChwb3MgKyBsZW4pKSB7CiAgICAgICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKHBvcyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKHBvcywgcG9zICsgbGVuKTsKICAgIHVxAH4ARAAAAGkASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBGACgAVgA8ADAAfAB8AFYAPgBWAC4AVgBnAHQAaAAoACkAKQB7AFIAVgA7AH0ASQBGACgAVgA8AFYAKQB7AFYAPQBWADsAfQBJAEYAKABWAC4AVgBnAHQAaAAoACkAPAA9ACgAVgArAFYAKQApAHsAUgBWAC4AcwB1AGIAVgBpAG4AZwAoAFYAKQA7AH0AUgBWAC4AcwB1AGIAVgBpAG4AZwAoAFYALABWACsAVgApADtzcQB+AD8AAAZMAAAGQAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBLgogICAgICAgIGlmIChpc0VtcHR5KHN0cikgfHwgc2VwYXJhdG9yID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CiAgICAgICAgaWYgKHNlcGFyYXRvci5sZW5ndGgoKSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWTsKICAgICAgICB9CiAgICAgICAgaW50IHBvcyA9IHN0ci5pbmRleE9mKHNlcGFyYXRvcik7CiAgICAgICAgaWYgKHBvcyA9PSAtMSkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc3RyLnN1YnN0cmluZygwLCBwb3MpOwogICAgdXEAfgBEAAAASwBJAEYAKABNACgAVgApAHwAfABWAD0APQBOAFUAKQB7AFIAVgA7AH0ASQBGACgAVgBNACgAKQA9AD0AVgApAHsAUgBWADsAfQBJAFYAPQBWAE0AKABWACkAOwBJAEYAKABWAD0APQAtAFYAKQB7AFIAVgA7AH0AUgBWAC4AcwB1AGIAVgBpAG4AZwAoAFYALABWACkAO3NxAH4APwAABnQAAAZoAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAEnCiAgICAgICAgaWYgKGlzRW1wdHkoc3RyKSkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICBpZiAoc2VwYXJhdG9yID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIEVNUFRZOwogICAgICAgIH0KICAgICAgICBpbnQgcG9zID0gc3RyLmluZGV4T2Yoc2VwYXJhdG9yKTsKICAgICAgICBpZiAocG9zID09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcocG9zICsgc2VwYXJhdG9yLmxlbmd0aCgpKTsKICAgIHVxAH4ARAAAAEUASQBGACgATQAoAFYAKQApAHsAUgBWADsAfQBJAEYAKABWAD0APQBOAFUAKQB7AFIAVgA7AH0ASQBWAD0AVgBNACgAVgApADsASQBGACgAVgA9AD0ALQBWACkAewBSAFYAOwB9AFIAVgAuAHMAdQBiAFYAaQBuAGcAKABWACsAVgBNACgAKQApADtzcQB+AD8AAAbBAAAGtQAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBWgogICAgICAgIGlmIChpc0VtcHR5KHN0cikpIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CiAgICAgICAgaWYgKGlzRW1wdHkoc2VwYXJhdG9yKSkgewogICAgICAgICAgICByZXR1cm4gRU1QVFk7CiAgICAgICAgfQogICAgICAgIGludCBwb3MgPSBzdHIubGFzdEluZGV4T2Yoc2VwYXJhdG9yKTsKICAgICAgICBpZiAocG9zID09IC0xIHx8IHBvcyA9PSAoc3RyLmxlbmd0aCgpIC0gc2VwYXJhdG9yLmxlbmd0aCgpKSkgewogICAgICAgICAgICByZXR1cm4gRU1QVFk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKHBvcyArIHNlcGFyYXRvci5sZW5ndGgoKSk7CiAgICB1cQB+AEQAAABUAEkARgAoAE0AKABWACkAKQB7AFIAVgA7AH0ASQBGACgATQAoAFYAKQApAHsAUgBWADsAfQBJAFYAPQBWAE0AKABWACkAOwBJAEYAKABWAD0APQAtADEAfAB8AFYAPQA9ACgAVgBNACgAKQAtAFYATQAoACkAKQApAHsAUgBWADsAfQBSAFYALgBzAHUAYgBWAGkAbgBnACgAVgArAFYATQAoACkAKQA7c3EAfgA/AAAHBQAABvkAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AXMKICAgICAgICBpZiAoc3RyID09IG51bGwgfHwgb3BlbiA9PSBudWxsIHx8IGNsb3NlID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGludCBzdGFydCA9IHN0ci5pbmRleE9mKG9wZW4pOwogICAgICAgIGlmIChzdGFydCAhPSAtMSkgewogICAgICAgICAgICBpbnQgZW5kID0gc3RyLmluZGV4T2YoY2xvc2UsIHN0YXJ0ICsgb3Blbi5sZW5ndGgoKSk7CiAgICAgICAgICAgIGlmIChlbmQgIT0gLTEpIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKHN0YXJ0ICsgb3Blbi5sZW5ndGgoKSwgZW5kKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIHVxAH4ARAAAAGUASQBGACgAVgA9AD0ATgBVAHwAfABWAD0APQBOAFUAfAB8AFYAPQA9AE4AVQApAHsAUgBOAFUAOwB9AEkAVgA9AFYATQAoAFYAKQA7AEkARgAoAFYAIQA9AC0AVgApAHsASQBWAD0AVgBNACgAVgAsAFYAKwBWAE0AKAApACkAOwBJAEYAKABWACEAPQAtAFYAKQB7AFIAVgAuAHMAdQBiAFYAaQBuAGcAKABWACsAVgBNACgAKQAsAFYAKQA7AH0AfQBSAE4AVQA7c3EAfgA/AAAHhAAAB28AAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0Al0KICAgICAgICBpZiAoYXJyYXkgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgaW50IGJ1ZlNpemUgPSAoZW5kSW5kZXggLSBzdGFydEluZGV4KTsKICAgICAgICBpZiAoYnVmU2l6ZSA8PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWTsKICAgICAgICB9CgogICAgICAgIGJ1ZlNpemUgKj0gKChhcnJheVtzdGFydEluZGV4XSA9PSBudWxsID8gMTYgOiBhcnJheVtzdGFydEluZGV4XS50b1N0cmluZygpLmxlbmd0aCgpKSArIDEpOwogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKGJ1ZlNpemUpOwoKICAgICAgICBmb3IgKGludCBpID0gc3RhcnRJbmRleDsgaSA8IGVuZEluZGV4OyBpKyspIHsKICAgICAgICAgICAgaWYgKGkgPiBzdGFydEluZGV4KSB7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKHNlcGFyYXRvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGFycmF5W2ldICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoYXJyYXlbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIHVxAH4ARAAAAKsASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBWAD0AKABWAC0AVgApADsASQBGACgAVgA8AD0AVgApAHsAUgBWADsAfQBiAHUAZgBTAGkAegBlACoAPQAoACgAVgBbAHMAdABhAHIAdABJAG4AZABlAHgAXQA9AD0ATgBVAD8AVgA6AFYAWwBzAHQAYQByAHQASQBuAGQAZQB4AF0ALgBNACgAKQAuAE0AKAApACkAKwBWACkAOwBNAFYAPQBOAE0AKABWAFMAaQB6AGUAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAVgA+AFYAKQB7AFYATQAoAFYAKQA7AH0ASQBGACgAVgBbAGkAXQAhAD0ATgBVACkAewBWAE0AKABWAFsAaQBdACkAOwB9AH0AUgBWAE0AKAApADtzcQB+AD8AAAfdAAAHwAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQC4gogICAgICAgIGlmIChhcnJheSA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAoc2VwYXJhdG9yID09IG51bGwpIHsKICAgICAgICAgICAgc2VwYXJhdG9yID0gRU1QVFk7CiAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaW50IGJ1ZlNpemUgPSAoZW5kSW5kZXggLSBzdGFydEluZGV4KTsKICAgICAgICBpZiAoYnVmU2l6ZSA8PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWTsKICAgICAgICB9CgogICAgICAgIGJ1ZlNpemUgKj0gKChhcnJheVtzdGFydEluZGV4XSA9PSBudWxsID8gMTYgOiBhcnJheVtzdGFydEluZGV4XS50b1N0cmluZygpLmxlbmd0aCgpKQogICAgICAgICAgICAgICAgICAgICAgICArIHNlcGFyYXRvci5sZW5ndGgoKSk7CgogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKGJ1ZlNpemUpOwoKICAgICAgICBmb3IgKGludCBpID0gc3RhcnRJbmRleDsgaSA8IGVuZEluZGV4OyBpKyspIHsKICAgICAgICAgICAgaWYgKGkgPiBzdGFydEluZGV4KSB7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKHNlcGFyYXRvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGFycmF5W2ldICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoYXJyYXlbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIHVxAH4ARAAAAL0ASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBGACgAVgA9AD0ATgBVACkAewBWAD0AVgA7AH0ASQBWAD0AKABWAC0AVgApADsASQBGACgAVgA8AD0AVgApAHsAUgBWADsAfQBiAHUAZgBTAGkAegBlACoAPQAoACgAVgBbAHMAdABhAHIAdABJAG4AZABlAHgAXQA9AD0ATgBVAD8AVgA6AFYAWwBzAHQAYQByAHQASQBuAGQAZQB4AF0ALgBNACgAKQAuAE0AKAApACkAKwBWAE0AKAApACkAOwBNAFYAPQBOAE0AKABWAFMAaQB6AGUAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAVgA+AFYAKQB7AFYATQAoAFYAKQA7AH0ASQBGACgAVgBbAGkAXQAhAD0ATgBVACkAewBWAE0AKABWAFsAaQBdACkAOwB9AH0AUgBWAE0AKAApADtzcQB+AD8AAAgAAAAH8AAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBqgogICAgICAgIGlmIChpc0VtcHR5KHN0cikpIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CiAgICAgICAgaW50IHN6ID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGNoYXJbXSBjaHMgPSBuZXcgY2hhcltzel07CiAgICAgICAgaW50IGNvdW50ID0gMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN6OyBpKyspIHsKICAgICAgICAgICAgaWYgKCFDaGFyYWN0ZXIuaXNXaGl0ZXNwYWNlKHN0ci5jaGFyQXQoaSkpKSB7CiAgICAgICAgICAgICAgICBjaHNbY291bnQrK10gPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChjb3VudCA9PSBzeikgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3IFN0cmluZyhjaHMsIDAsIGNvdW50KTsKICAgIHVxAH4ARAAAAHsASQBGACgATQAoAFYAKQApAHsAUgBWADsAfQBJAFYAPQBWAE0AKAApADsAVgBbAF0AVgA9AE4AVgBbAHMAegBdADsASQBWAD0AVgA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAIQBWAC4AVgBzAFcAaABWAHQAZQBzAHAAYQBjAGUAKABWAE0AKABWACkAKQApAHsAVgBbAFYAKwArAF0APQBWAE0AKABWACkAOwB9AH0ASQBGACgAVgA9AD0AVgApAHsAUgBWADsAfQBSAE4ATQAoAFYALABWACwAVgApADtzcQB+AD8AAAjKAAAIvgAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBYQogICAgICAgIGlmIChpc0VtcHR5KHN0cikgfHwgc3RyLmluZGV4T2YocmVtb3ZlKSA9PSAtMSkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICBjaGFyW10gY2hhcnMgPSBzdHIudG9DaGFyQXJyYXkoKTsKICAgICAgICBpbnQgcG9zID0gMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjaGFyc1tpXSAhPSByZW1vdmUpIHsKICAgICAgICAgICAgICAgIGNoYXJzW3BvcysrXSA9IGNoYXJzW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgU3RyaW5nKGNoYXJzLCAwLCBwb3MpOwogICAgdXEAfgBEAAAAYABJAEYAKABNACgAVgApAHwAfABWAE0AKABWACkAPQA9AC0AVgApAHsAUgBWADsAfQBWAFsAXQBWAHMAPQBWAE0AKAApADsASQBWAD0AVgA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsASQBGACgAVgBbAGkAXQAhAD0AVgApAHsAVgBbAFYAKwArAF0APQBWAFsAaQBdADsAfQB9AFIATgBNACgAVgAsAFYALABWACkAO3NxAH4APwAACTgAAAkgAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAN+CiAgICAgICAgaWYgKGlzRW1wdHkodGV4dCkgfHwgaXNFbXB0eShzZWFyY2hTdHJpbmcpIHx8IHJlcGxhY2VtZW50ID09IG51bGwgfHwgbWF4ID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHRleHQ7CiAgICAgICAgfQogICAgICAgIGludCBzdGFydCA9IDA7CiAgICAgICAgaW50IGVuZCA9IHRleHQuaW5kZXhPZihzZWFyY2hTdHJpbmcsIHN0YXJ0KTsKICAgICAgICBpZiAoZW5kID09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiB0ZXh0OwogICAgICAgIH0KICAgICAgICBpbnQgcmVwbExlbmd0aCA9IHNlYXJjaFN0cmluZy5sZW5ndGgoKTsKICAgICAgICBpbnQgaW5jcmVhc2UgPSByZXBsYWNlbWVudC5sZW5ndGgoKSAtIHJlcGxMZW5ndGg7CiAgICAgICAgaW5jcmVhc2UgPSAoaW5jcmVhc2UgPCAwID8gMCA6IGluY3JlYXNlKTsKICAgICAgICBpbmNyZWFzZSAqPSAobWF4IDwgMCA/IDE2IDogKG1heCA+IDY0ID8gNjQgOiBtYXgpKTsKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcih0ZXh0Lmxlbmd0aCgpICsgaW5jcmVhc2UpOwogICAgICAgIHdoaWxlIChlbmQgIT0gLTEpIHsKICAgICAgICAgICAgYnVmLmFwcGVuZCh0ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKSkuYXBwZW5kKHJlcGxhY2VtZW50KTsKICAgICAgICAgICAgc3RhcnQgPSBlbmQgKyByZXBsTGVuZ3RoOwogICAgICAgICAgICBpZiAoLS1tYXggPT0gMCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZW5kID0gdGV4dC5pbmRleE9mKHNlYXJjaFN0cmluZywgc3RhcnQpOwogICAgICAgIH0KICAgICAgICBidWYuYXBwZW5kKHRleHQuc3Vic3RyaW5nKHN0YXJ0KSk7CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgdXEAfgBEAAAA2ABJAEYAKABNACgAVgApAHwAfABNACgAVgApAHwAfABWAD0APQBOAFUAfAB8AFYAPQA9AFYAKQB7AFIAVgA7AH0ASQBWAD0AVgA7AEkAVgA9AFYATQAoAFYALABWACkAOwBJAEYAKABWAD0APQAtAFYAKQB7AFIAVgA7AH0ASQBWAD0AVgBNACgAKQA7AEkAVgA9AFYATQAoACkALQBWADsAVgA9ACgAVgA8AFYAPwBWADoAVgApADsAaQBuAGMAcgBlAGEAcwBlACoAPQAoAFYAPAAwAD8AVgA6ACgAVgA+AFYANAA/AFYANAA6AFYAKQApADsATQBWAD0ATgBNACgAVgBNACgAKQArAFYAKQA7AFcAKABWACEAPQAtAFYAKQB7AFYALgBhAHAAcABWACgAVgBNACgAVgAsAFYAKQApAC4AYQBwAHAAVgAoAFYAKQA7AFYAPQBWACsAVgA7AEkARgAoAC0ALQBWAD0APQBWACkAewBWADsAfQBWAD0AVgBNACgAVgAsAFYAKQA7AH0AVgBNACgAVgBNACgAVgApACkAOwBSAFYATQAoACkAO3NxAH4APwAACkcAAAnLAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdA2zCgogICAgICAgICAgICAgICAgCiAgICAgICAgaWYgKHRleHQgPT0gbnVsbCB8fCB0ZXh0Lmxlbmd0aCgpID09IDAgfHwgc2VhcmNoTGlzdCA9PSBudWxsIHx8IAogICAgICAgICAgICBzZWFyY2hMaXN0Lmxlbmd0aCA9PSAwIHx8IHJlcGxhY2VtZW50TGlzdCA9PSBudWxsIHx8IHJlcGxhY2VtZW50TGlzdC5sZW5ndGggPT0gMCkgCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gdGV4dDsKICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRpbWVUb0xpdmUgPCAwKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oIlRpbWVUb0xpdmUgb2YgIiArIHRpbWVUb0xpdmUgKyAiIGlzIGxlc3MgdGhhbiAwOiAiICsgdGV4dCk7CiAgICAgICAgfQoKICAgICAgICBpbnQgc2VhcmNoTGVuZ3RoID0gc2VhcmNoTGlzdC5sZW5ndGg7CiAgICAgICAgaW50IHJlcGxhY2VtZW50TGVuZ3RoID0gcmVwbGFjZW1lbnRMaXN0Lmxlbmd0aDsKCiAgICAgICAgICAgICAgICBpZiAoc2VhcmNoTGVuZ3RoICE9IHJlcGxhY2VtZW50TGVuZ3RoKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIlNlYXJjaCBhbmQgUmVwbGFjZSBhcnJheSBsZW5ndGhzIGRvbid0IG1hdGNoOiAiCiAgICAgICAgICAgICAgICArIHNlYXJjaExlbmd0aAogICAgICAgICAgICAgICAgKyAiIHZzICIKICAgICAgICAgICAgICAgICsgcmVwbGFjZW1lbnRMZW5ndGgpOwogICAgICAgIH0KCiAgICAgICAgICAgICAgICBib29sZWFuW10gbm9Nb3JlTWF0Y2hlc0ZvclJlcGxJbmRleCA9IG5ldyBib29sZWFuW3NlYXJjaExlbmd0aF07CgogICAgICAgICAgICAgICAgaW50IHRleHRJbmRleCA9IC0xOwogICAgICAgIGludCByZXBsYWNlSW5kZXggPSAtMTsKICAgICAgICBpbnQgdGVtcEluZGV4ID0gLTE7CgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlYXJjaExlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChub01vcmVNYXRjaGVzRm9yUmVwbEluZGV4W2ldIHx8IHNlYXJjaExpc3RbaV0gPT0gbnVsbCB8fCAKICAgICAgICAgICAgICAgIHNlYXJjaExpc3RbaV0ubGVuZ3RoKCkgPT0gMCB8fCByZXBsYWNlbWVudExpc3RbaV0gPT0gbnVsbCkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRlbXBJbmRleCA9IHRleHQuaW5kZXhPZihzZWFyY2hMaXN0W2ldKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wSW5kZXggPT0gLTEpIHsKICAgICAgICAgICAgICAgIG5vTW9yZU1hdGNoZXNGb3JSZXBsSW5kZXhbaV0gPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHRleHRJbmRleCA9PSAtMSB8fCB0ZW1wSW5kZXggPCB0ZXh0SW5kZXgpIHsKICAgICAgICAgICAgICAgICAgICB0ZXh0SW5kZXggPSB0ZW1wSW5kZXg7CiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZUluZGV4ID0gaTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgICAgIGlmICh0ZXh0SW5kZXggPT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuIHRleHQ7CiAgICAgICAgfQoKICAgICAgICBpbnQgc3RhcnQgPSAwOwoKICAgICAgICAgICAgICAgIGludCBpbmNyZWFzZSA9IDA7CgogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWFyY2hMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGludCBncmVhdGVyID0gcmVwbGFjZW1lbnRMaXN0W2ldLmxlbmd0aCgpIC0gc2VhcmNoTGlzdFtpXS5sZW5ndGgoKTsKICAgICAgICAgICAgaWYgKGdyZWF0ZXIgPiAwKSB7CiAgICAgICAgICAgICAgICBpbmNyZWFzZSArPSAzICogZ3JlYXRlcjsgICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAgICAgICAgIGluY3JlYXNlID0gTWF0aC5taW4oaW5jcmVhc2UsIHRleHQubGVuZ3RoKCkgLyA1KTsKCiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIodGV4dC5sZW5ndGgoKSArIGluY3JlYXNlKTsKCiAgICAgICAgd2hpbGUgKHRleHRJbmRleCAhPSAtMSkgewoKICAgICAgICAgICAgZm9yIChpbnQgaSA9IHN0YXJ0OyBpIDwgdGV4dEluZGV4OyBpKyspIHsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQodGV4dC5jaGFyQXQoaSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQocmVwbGFjZW1lbnRMaXN0W3JlcGxhY2VJbmRleF0pOwoKICAgICAgICAgICAgc3RhcnQgPSB0ZXh0SW5kZXggKyBzZWFyY2hMaXN0W3JlcGxhY2VJbmRleF0ubGVuZ3RoKCk7CgogICAgICAgICAgICB0ZXh0SW5kZXggPSAtMTsKICAgICAgICAgICAgcmVwbGFjZUluZGV4ID0gLTE7CiAgICAgICAgICAgIHRlbXBJbmRleCA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlYXJjaExlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAobm9Nb3JlTWF0Y2hlc0ZvclJlcGxJbmRleFtpXSB8fCBzZWFyY2hMaXN0W2ldID09IG51bGwgfHwgCiAgICAgICAgICAgICAgICAgICAgc2VhcmNoTGlzdFtpXS5sZW5ndGgoKSA9PSAwIHx8IHJlcGxhY2VtZW50TGlzdFtpXSA9PSBudWxsKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRlbXBJbmRleCA9IHRleHQuaW5kZXhPZihzZWFyY2hMaXN0W2ldLCBzdGFydCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wSW5kZXggPT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICBub01vcmVNYXRjaGVzRm9yUmVwbEluZGV4W2ldID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHRJbmRleCA9PSAtMSB8fCB0ZW1wSW5kZXggPCB0ZXh0SW5kZXgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEluZGV4ID0gdGVtcEluZGV4OwogICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlSW5kZXggPSBpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgaW50IHRleHRMZW5ndGggPSB0ZXh0Lmxlbmd0aCgpOwogICAgICAgIGZvciAoaW50IGkgPSBzdGFydDsgaSA8IHRleHRMZW5ndGg7IGkrKykgewogICAgICAgICAgICBidWYuYXBwZW5kKHRleHQuY2hhckF0KGkpKTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nIHJlc3VsdCA9IGJ1Zi50b1N0cmluZygpOwogICAgICAgIGlmICghcmVwZWF0KSB7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVwbGFjZUVhY2gocmVzdWx0LCBzZWFyY2hMaXN0LCByZXBsYWNlbWVudExpc3QsIHJlcGVhdCwgdGltZVRvTGl2ZSAtIDEpOwogICAgdXEAfgBEAAACygBJAEYAKABWAD0APQBOAFUAfAB8AFYATQAoACkAPQA9ADAAfAB8AFYAPQA9AE4AVQB8AHwAVgA9AD0AVgB8AHwAVgA9AD0ATgBVAHwAfABWAC4AbABlAG4AZwB0AGgAPQA9AFYAKQB7AFIAVgA7AH0ASQBGACgAVgA8AFYAKQB7AFQASABOAE0AKAAjACMAKwBWACsAIwAjACsAVgApADsAfQBJAFYAPQBWADsASQBWAD0AVgA7AEkARgAoAFYAIQA9AFYAKQB7AFQASABOAE0AKAAjACMAKwBzAGUAYQByAGMAaABMAGUAbgBnAHQAaAArACMAIwArAFYAKQA7AH0AVgBbAF0AVgA9AE4AVgBbAHMAZQBhAHIAYwBoAEwAZQBuAGcAdABoAF0AOwBJAFYAPQAtAFYAOwBJAFYAPQAtAFYAOwBJAFYAPQAtAFYAOwBGAE8AKABWAG4AdABWAD0AVgA7AFYAPABWADsAVgArACsAKQB7AEkARgAoAFYAWwBpAF0AfAB8AFYAWwBpAF0APQA9AE4AVQB8AHwAVgBbAGkAXQAuAE0AKAApAD0APQAwAHwAfABWAFsAaQBdAD0APQBOAFUAKQB7AFYAOwB9AFYAPQBWAE0AKABWAFsAaQBdACkAOwBJAEYAKABWAD0APQAtAFYAKQB7AFYAWwBpAF0APQBUAEUAOwB9AEUATAB7AEkARgAoAFYAPQA9AC0AMQB8AHwAVgA8AFYAKQB7AFYAPQBWADsAVgA9AFYAOwB9AH0AfQBJAEYAKABWAD0APQAtAFYAKQB7AFIAVgA7AH0ASQBWAD0AVgA7AEkAVgA9AFYAOwBGAE8AKABWAG4AdABWAD0AVgA7AFYAPABzAGUAYQByAGMAaABMAFYAcwB0AC4AbABlAG4AZwB0AGgAOwBWACsAKwApAHsASQBWAD0AVgBbAGkAXQAuAE0AKAApAC0AVgBbAGkAXQAuAE0AKAApADsASQBGACgAVgA+AFYAKQB7AFYAKwA9ADMAKgBWADsAfQB9AFYAPQBWAE0AKABWACwAVgBNACgAKQAvAFYAKQA7AE0AVgA9AE4ATQAoAFYATQAoACkAKwBWACkAOwBXACgAVgAhAD0ALQBWACkAewBGAE8AKABWAG4AdABWAD0AVgA7AFYAPABWADsAVgArACsAKQB7AFYATQAoAFYATQAoAFYAKQApADsAfQBWAE0AKABWAFsAcgBlAHAAbABhAGMAZQBJAG4AZABlAHgAXQApADsAVgA9AFYAKwBWAFsAcgBlAHAAbABhAGMAZQBJAG4AZABlAHgAXQAuAE0AKAApADsAVgA9AC0AVgA7AFYAPQAtAFYAOwBWAD0ALQBWADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBJAEYAKABWAFsAaQBdAHwAfABWAFsAaQBdAD0APQBOAFUAfAB8AFYAWwBpAF0ALgBNACgAKQA9AD0AMAB8AHwAVgBbAGkAXQA9AD0ATgBVACkAewBWADsAfQBWAD0AVgBNACgAVgBbAGkAXQAsAFYAKQA7AEkARgAoAFYAPQA9AC0AVgApAHsAVgBbAGkAXQA9AFQARQA7AH0ARQBMAHsASQBGACgAVgA9AD0ALQAxAHwAfABWADwAVgApAHsAVgA9AFYAOwBWAD0AVgA7AH0AfQB9AH0ASQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBNACgAVgBNACgAVgApACkAOwB9AFMAVgA9AFYATQAoACkAOwBJAEYAKAAhAFYAKQB7AFIAVgA7AH0AUgBNACgAVgAsAFYALABWACwAVgAsAFYALQBWACkAO3NxAH4APwAACqUAAAqKAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdANMCiAgICAgICAgaWYgKGlzRW1wdHkoc3RyKSB8fCBpc0VtcHR5KHNlYXJjaENoYXJzKSkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICBpZiAocmVwbGFjZUNoYXJzID09IG51bGwpIHsKICAgICAgICAgICAgcmVwbGFjZUNoYXJzID0gRU1QVFk7CiAgICAgICAgfQogICAgICAgIGJvb2xlYW4gbW9kaWZpZWQgPSBmYWxzZTsKICAgICAgICBpbnQgcmVwbGFjZUNoYXJzTGVuZ3RoID0gcmVwbGFjZUNoYXJzLmxlbmd0aCgpOwogICAgICAgIGludCBzdHJMZW5ndGggPSBzdHIubGVuZ3RoKCk7CiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoc3RyTGVuZ3RoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN0ckxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNoYXIgY2ggPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICBpbnQgaW5kZXggPSBzZWFyY2hDaGFycy5pbmRleE9mKGNoKTsKICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHsKICAgICAgICAgICAgICAgIG1vZGlmaWVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGlmIChpbmRleCA8IHJlcGxhY2VDaGFyc0xlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQocmVwbGFjZUNoYXJzLmNoYXJBdChpbmRleCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChjaCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKG1vZGlmaWVkKSB7CiAgICAgICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cjsKICAgIHVxAH4ARAAAAK0ASQBGACgATQAoAFYAKQB8AHwATQAoAFYAKQApAHsAUgBWADsAfQBJAEYAKABWAD0APQBOAFUAKQB7AFYAPQBWADsAfQBCAE8AVgA9AEYAOwBJAFYAPQBWAE0AKAApADsASQBWAD0AVgBNACgAKQA7AE0AVgA9AE4ATQAoAFYAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBhAHIAVgA9AFYALgBWAGEAcgBBAHQAKABWACkAOwBJAFYAPQBWAC4AVgBPAGYAKABWACkAOwBJAEYAKABWAD4APQBWACkAewBWAD0AVABFADsASQBGACgAVgA8AFYAKQB7AFYATQAoAFYATQAoAFYAKQApADsAfQB9AEUATAB7AFYATQAoAFYAKQA7AH0AfQBJAEYAKABWACkAewBSAFYATQAoACkAOwB9AFIAVgA7c3EAfgA/AAALBQAACucAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AtoKICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChvdmVybGF5ID09IG51bGwpIHsKICAgICAgICAgICAgb3ZlcmxheSA9IEVNUFRZOwogICAgICAgIH0KICAgICAgICBpbnQgbGVuID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGlmIChzdGFydCA8IDApIHsKICAgICAgICAgICAgc3RhcnQgPSAwOwogICAgICAgIH0KICAgICAgICBpZiAoc3RhcnQgPiBsZW4pIHsKICAgICAgICAgICAgc3RhcnQgPSBsZW47CiAgICAgICAgfQogICAgICAgIGlmIChlbmQgPCAwKSB7CiAgICAgICAgICAgIGVuZCA9IDA7CiAgICAgICAgfQogICAgICAgIGlmIChlbmQgPiBsZW4pIHsKICAgICAgICAgICAgZW5kID0gbGVuOwogICAgICAgIH0KICAgICAgICBpZiAoc3RhcnQgPiBlbmQpIHsKICAgICAgICAgICAgaW50IHRlbXAgPSBzdGFydDsKICAgICAgICAgICAgc3RhcnQgPSBlbmQ7CiAgICAgICAgICAgIGVuZCA9IHRlbXA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgU3RyaW5nQnVmZmVyKGxlbiArIHN0YXJ0IC0gZW5kICsgb3ZlcmxheS5sZW5ndGgoKSArIDEpCiAgICAgICAgICAgIC5hcHBlbmQoc3RyLnN1YnN0cmluZygwLCBzdGFydCkpCiAgICAgICAgICAgIC5hcHBlbmQob3ZlcmxheSkKICAgICAgICAgICAgLmFwcGVuZChzdHIuc3Vic3RyaW5nKGVuZCkpCiAgICAgICAgICAgIC50b1N0cmluZygpOwogICAgdXEAfgBEAAAAuABJAEYAKABWAD0APQBOAFUAKQB7AFIATgBVADsAfQBJAEYAKABWAD0APQBOAFUAKQB7AFYAPQBWADsAfQBJAFYAPQBWAC4AVgBnAHQAaAAoACkAOwBJAEYAKABWADwAVgApAHsAVgA9AFYAOwB9AEkARgAoAFYAPgBWACkAewBWAD0AVgA7AH0ASQBGACgAVgA8AFYAKQB7AFYAPQBWADsAfQBJAEYAKABWAD4AVgApAHsAVgA9AFYAOwB9AEkARgAoAFYAPgBWACkAewBJAFYAPQBWADsAVgA9AFYAOwBWAD0AVgA7AH0AUgBOAE0AKABWACsAVgAtAFYAKwBWAC4AVgBnAHQAaAAoACkAKwBWACkALgBNACgAVgAuAHMAdQBiAFYAaQBuAGcAKABWACwAVgApACkALgBNACgAVgApAC4AYQBwAHAAVgAoAFYALgBzAHUAYgBWAGkAbgBnACgAVgApACkALgBNACgAKQA7c3EAfgA/AAALOgAACyIAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AmUKICAgICAgICBpZiAoaXNFbXB0eShzdHIpKSB7CiAgICAgICAgICAgIHJldHVybiBzdHI7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RyLmxlbmd0aCgpID09IDEpIHsKICAgICAgICAgICAgY2hhciBjaCA9IHN0ci5jaGFyQXQoMCk7CiAgICAgICAgICAgIGlmIChjaCA9PSBDaGFyVXRpbHMuQ1IgfHwgY2ggPT0gQ2hhclV0aWxzLkxGKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CgogICAgICAgIGludCBsYXN0SWR4ID0gc3RyLmxlbmd0aCgpIC0gMTsKICAgICAgICBjaGFyIGxhc3QgPSBzdHIuY2hhckF0KGxhc3RJZHgpOwoKICAgICAgICBpZiAobGFzdCA9PSBDaGFyVXRpbHMuTEYpIHsKICAgICAgICAgICAgaWYgKHN0ci5jaGFyQXQobGFzdElkeCAtIDEpID09IENoYXJVdGlscy5DUikgewogICAgICAgICAgICAgICAgbGFzdElkeC0tOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChsYXN0ICE9IENoYXJVdGlscy5DUikgewogICAgICAgICAgICBsYXN0SWR4Kys7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIGxhc3RJZHgpOwogICAgdXEAfgBEAAAAmwBJAEYAKABNACgAVgApACkAewBSAFYAOwB9AEkARgAoAFYATQAoACkAPQA9AFYAKQB7AFYAYQByAFYAPQBWAC4AVgBhAHIAQQB0ACgAVgApADsASQBGACgAVgA9AD0AVgAuAEMAUgB8AHwAVgA9AD0AVgAuAEwARgApAHsAUgBWADsAfQBSAFYAOwB9AEkAVgA9AFYATQAoACkALQBWADsAQwBIAFYAPQBWAE0AKABWAEkAZAB4ACkAOwBJAEYAKABWAD0APQBWACkAewBJAEYAKABWAE0AKABWAC0AVgApAD0APQBWACkAewBWAC0ALQA7AH0AfQBFAEwASQBGACgAVgAhAD0AVgApAHsAVgArACsAOwB9AFIAVgAuAHMAdQBiAFYAaQBuAGcAKABWACwAVgApADtzcQB+AD8AAAuBAAALeAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBCAogICAgICAgIGlmIChzdHIubGVuZ3RoKCkgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICBTdHJpbmcgc3ViID0gc3RyLnN1YnN0cmluZyhzdHIubGVuZ3RoKCkgLSBzZXAubGVuZ3RoKCkpOwogICAgICAgIGlmIChzZXAuZXF1YWxzKHN1YikpIHsKICAgICAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgc3RyLmxlbmd0aCgpIC0gc2VwLmxlbmd0aCgpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cjsKICAgIHVxAH4ARAAAAEwASQBGACgAVgBNACgAKQA9AD0AVgApAHsAUgBWADsAfQBTAFYAPQBWAC4AVgBWAGkAbgBnACgAVgBNACgAKQAtAFYATQAoACkAKQA7AEkARgAoAFYATQAoAFYAKQApAHsAUgBWAC4AcwB1AGIAVgBpAG4AZwAoAFYALABWAE0AKAApAC0AVgBNACgAKQApADsAfQBSAFYAO3NxAH4APwAAC5gAAAuPAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdADzCiAgICAgICAgaW50IGlkeCA9IHN0ci5sYXN0SW5kZXhPZihzZXApOwogICAgICAgIGlmIChpZHggPT0gc3RyLmxlbmd0aCgpIC0gc2VwLmxlbmd0aCgpKSB7CiAgICAgICAgICAgIHJldHVybiBzZXA7CiAgICAgICAgfSBlbHNlIGlmIChpZHggIT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoaWR4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gRU1QVFk7CiAgICAgICAgfQogICAgdXEAfgBEAAAAQABJAFYAPQBWAE0AKABWACkAOwBJAEYAKABWAD0APQBWAE0AKAApAC0AVgBNACgAKQApAHsAUgBWADsAfQBFAEwASQBGACgAVgAhAD0ALQBWACkAewBSAFYALgBzAHUAYgBWAGkAbgBnACgAVgApADsAfQBFAEwAewBSAFYAOwB9c3EAfgA/AAAL6wAAC9oAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AeAKICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGludCBzdHJMZW4gPSBzdHIubGVuZ3RoKCk7CiAgICAgICAgaWYgKHN0ckxlbiA8IDIpIHsKICAgICAgICAgICAgcmV0dXJuIEVNUFRZOwogICAgICAgIH0KICAgICAgICBpbnQgbGFzdElkeCA9IHN0ckxlbiAtIDE7CiAgICAgICAgU3RyaW5nIHJldCA9IHN0ci5zdWJzdHJpbmcoMCwgbGFzdElkeCk7CiAgICAgICAgY2hhciBsYXN0ID0gc3RyLmNoYXJBdChsYXN0SWR4KTsKICAgICAgICBpZiAobGFzdCA9PSBDaGFyVXRpbHMuTEYpIHsKICAgICAgICAgICAgaWYgKHJldC5jaGFyQXQobGFzdElkeCAtIDEpID09IENoYXJVdGlscy5DUikgewogICAgICAgICAgICAgICAgcmV0dXJuIHJldC5zdWJzdHJpbmcoMCwgbGFzdElkeCAtIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXQ7CiAgICB1cQB+AEQAAAB3AEkARgAoAFYAPQA9AE4AVQApAHsAUgBOAFUAOwB9AEkAVgA9AFYATQAoACkAOwBJAEYAKABWADwAVgApAHsAUgBWADsAfQBJAFYAPQBWAC0AVgA7AFMAVgA9AFYALgBzAHUAYgBWAGkAbgBnACgAVgAsAFYAKQA7AEMASABWAD0AVgBNACgAVgBJAGQAeAApADsASQBGACgAVgA9AD0AVgApAHsASQBGACgAVgBNACgAVgAtAFYAKQA9AD0AVgApAHsAVgB1AHIAbgBWAE0AKABWACwAVgAtAFYAKQA7AH0AfQBWAHUAcgBuAFYAO3NxAH4APwAADAUAAAv3AAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAF6CiAgICAgICAgaW50IGxhc3RJZHggPSBzdHIubGVuZ3RoKCkgLSAxOwogICAgICAgIGlmIChsYXN0SWR4IDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuIEVNUFRZOwogICAgICAgIH0KICAgICAgICBjaGFyIGxhc3QgPSBzdHIuY2hhckF0KGxhc3RJZHgpOwogICAgICAgIGlmIChsYXN0ID09IENoYXJVdGlscy5MRikgewogICAgICAgICAgICBpZiAoc3RyLmNoYXJBdChsYXN0SWR4IC0gMSkgPT0gQ2hhclV0aWxzLkNSKSB7CiAgICAgICAgICAgICAgICBsYXN0SWR4LS07CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsYXN0SWR4Kys7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIGxhc3RJZHgpOwogICAgdXEAfgBEAAAAWgBJAFYAPQBWAE0AKAApAC0AVgA7AEkARgAoAFYAPAA9AFYAKQB7AFIAVgA7AH0AQwBIAFYAPQBWAE0AKABWAEkAZAB4ACkAOwBJAEYAKABWAD0APQBWACkAewBJAEYAKABWAE0AKABWAC0AVgApAD0APQBWACkAewBWAC0ALQA7AH0AfQBFAEwAewBWACsAKwA7AH0AUgBWAC4AcwB1AGIAVgBpAG4AZwAoAFYALABWACkAO3NxAH4APwAADFsAAAwxAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAVACiAgICAgICAgCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAocmVwZWF0IDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuIEVNUFRZOwogICAgICAgIH0KICAgICAgICBpbnQgaW5wdXRMZW5ndGggPSBzdHIubGVuZ3RoKCk7CiAgICAgICAgaWYgKHJlcGVhdCA9PSAxIHx8IGlucHV0TGVuZ3RoID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CiAgICAgICAgaWYgKGlucHV0TGVuZ3RoID09IDEgJiYgcmVwZWF0IDw9IFBBRF9MSU1JVCkgewogICAgICAgICAgICByZXR1cm4gcGFkZGluZyhyZXBlYXQsIHN0ci5jaGFyQXQoMCkpOwogICAgICAgIH0KCiAgICAgICAgaW50IG91dHB1dExlbmd0aCA9IGlucHV0TGVuZ3RoICogcmVwZWF0OwogICAgICAgIHN3aXRjaCAoaW5wdXRMZW5ndGgpIHsKICAgICAgICAgICAgY2FzZSAxIDoKICAgICAgICAgICAgICAgIGNoYXIgY2ggPSBzdHIuY2hhckF0KDApOwogICAgICAgICAgICAgICAgY2hhcltdIG91dHB1dDEgPSBuZXcgY2hhcltvdXRwdXRMZW5ndGhdOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IHJlcGVhdCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgb3V0cHV0MVtpXSA9IGNoOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmcob3V0cHV0MSk7CiAgICAgICAgICAgIGNhc2UgMiA6CiAgICAgICAgICAgICAgICBjaGFyIGNoMCA9IHN0ci5jaGFyQXQoMCk7CiAgICAgICAgICAgICAgICBjaGFyIGNoMSA9IHN0ci5jaGFyQXQoMSk7CiAgICAgICAgICAgICAgICBjaGFyW10gb3V0cHV0MiA9IG5ldyBjaGFyW291dHB1dExlbmd0aF07CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gcmVwZWF0ICogMiAtIDI7IGkgPj0gMDsgaS0tLCBpLS0pIHsKICAgICAgICAgICAgICAgICAgICBvdXRwdXQyW2ldID0gY2gwOwogICAgICAgICAgICAgICAgICAgIG91dHB1dDJbaSArIDFdID0gY2gxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmcob3V0cHV0Mik7CiAgICAgICAgICAgIGRlZmF1bHQgOgogICAgICAgICAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIob3V0cHV0TGVuZ3RoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcmVwZWF0OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKHN0cik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgdXEAfgBEAAABSQBJAEYAKABWAD0APQBOAFUAKQB7AFIATgBVADsAfQBJAEYAKABWADwAPQBWACkAewBSAFYAOwB9AEkAVgA9AFYATQAoACkAOwBJAEYAKABWAD0APQAxAHwAfABWAD0APQBWACkAewBSAFYAOwB9AEkARgAoAFYAPQA9ADEAJgAmAFYAPAA9AFYAKQB7AFIATQAoAFYALABWAE0AKABWACkAKQA7AH0ASQBWAD0AaQBuAHAAdQB0AEwAZQBuAGcAdABoACoAVgA7AFMAKABWACkAewBWAFYAOgBWAGEAcgBWAD0AVgAuAFYAYQByAEEAdAAoAFYAKQA7AFYAWwBdAFYAPQBOAFYAWwBvAHUAdABwAHUAdABMAGUAbgBnAHQAaABdADsARgBPACgAVgBuAHQAVgA9AFYALQBWADsAVgA+AD0AVgA7AFYALQAtACkAewBWAFsAaQBdAD0AVgA7AH0AUgBOAE0AKABWACkAOwBWAFYAOgBDAEgAVgA9AFYATQAoAFYAKQA7AEMASABWAD0AVgBNACgAVgApADsAVgBbAF0AVgA9AE4AVgBbAG8AdQB0AHAAdQB0AEwAZQBuAGcAdABoAF0AOwBGAE8AKABWAG4AdABWAD0AcgBlAHAAZQBhAHQAKgBWAC0AVgA7AFYAPgA9AFYAOwBWAC0ALQAsAFYALQAtACkAewBWAFsAaQBdAD0AVgA7AFYAWwBWACsAMQBdAD0AVgA7AH0AUgBOAE0AKABWACkAOwBWADoATQBWAD0ATgBNACgAVgApADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBWAE0AKABWACkAOwB9AFIAVgBNACgAKQA7AH1zcQB+AD8AAAx9AAAMdAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBKQogICAgICAgIGlmIChyZXBlYXQgPCAwKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKCJDYW5ub3QgcGFkIGEgbmVnYXRpdmUgYW1vdW50OiAiICsgcmVwZWF0KTsKICAgICAgICB9CiAgICAgICAgZmluYWwgY2hhcltdIGJ1ZiA9IG5ldyBjaGFyW3JlcGVhdF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBidWYubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYnVmW2ldID0gcGFkQ2hhcjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmcoYnVmKTsKICAgIHVxAH4ARAAAAEgASQBGACgAVgA8AFYAKQB7AFQASABOAE0AKAAjACMAKwBWACkAOwB9AEYATABWAFsAXQBWAD0ATgBWAFsAcgBlAHAAZQBhAHQAXQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBbAGkAXQA9AFYAOwB9AFIATgBNACgAVgApADtzcQB+AD8AAAy3AAAMqwAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBRAogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgaW50IHBhZHMgPSBzaXplIC0gc3RyLmxlbmd0aCgpOwogICAgICAgIGlmIChwYWRzIDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsgICAgICAgICB9CiAgICAgICAgaWYgKHBhZHMgPiBQQURfTElNSVQpIHsKICAgICAgICAgICAgcmV0dXJuIHJpZ2h0UGFkKHN0ciwgc2l6ZSwgU3RyaW5nLnZhbHVlT2YocGFkQ2hhcikpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc3RyLmNvbmNhdChwYWRkaW5nKHBhZHMsIHBhZENoYXIpKTsKICAgIHVxAH4ARAAAAEkASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBWAD0AVgAtAFYATQAoACkAOwBJAEYAKABWADwAPQBWACkAewBSAFYAOwB9AEkARgAoAFYAPgBWACkAewBSAE0AKABWACwAVgAsAFYATQAoAFYAKQApADsAfQBSAFYATQAoAE0AKABWACwAVgApACkAO3NxAH4APwAADO0AAAzQAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdANiCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAoaXNFbXB0eShwYWRTdHIpKSB7CiAgICAgICAgICAgIHBhZFN0ciA9ICIgIjsKICAgICAgICB9CiAgICAgICAgaW50IHBhZExlbiA9IHBhZFN0ci5sZW5ndGgoKTsKICAgICAgICBpbnQgc3RyTGVuID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGludCBwYWRzID0gc2l6ZSAtIHN0ckxlbjsKICAgICAgICBpZiAocGFkcyA8PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBzdHI7ICAgICAgICAgfQogICAgICAgIGlmIChwYWRMZW4gPT0gMSAmJiBwYWRzIDw9IFBBRF9MSU1JVCkgewogICAgICAgICAgICByZXR1cm4gcmlnaHRQYWQoc3RyLCBzaXplLCBwYWRTdHIuY2hhckF0KDApKTsKICAgICAgICB9CgogICAgICAgIGlmIChwYWRzID09IHBhZExlbikgewogICAgICAgICAgICByZXR1cm4gc3RyLmNvbmNhdChwYWRTdHIpOwogICAgICAgIH0gZWxzZSBpZiAocGFkcyA8IHBhZExlbikgewogICAgICAgICAgICByZXR1cm4gc3RyLmNvbmNhdChwYWRTdHIuc3Vic3RyaW5nKDAsIHBhZHMpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjaGFyW10gcGFkZGluZyA9IG5ldyBjaGFyW3BhZHNdOwogICAgICAgICAgICBjaGFyW10gcGFkQ2hhcnMgPSBwYWRTdHIudG9DaGFyQXJyYXkoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwYWRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHBhZGRpbmdbaV0gPSBwYWRDaGFyc1tpICUgcGFkTGVuXTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc3RyLmNvbmNhdChuZXcgU3RyaW5nKHBhZGRpbmcpKTsKICAgICAgICB9CiAgICB1cQB+AEQAAADcAEkARgAoAFYAPQA9AE4AVQApAHsAUgBOAFUAOwB9AEkARgAoAE0AKABWACkAKQB7AFYAPQAjACMAOwB9AEkAVgA9AFYATQAoACkAOwBJAFYAPQBWAE0AKAApADsASQBWAD0AVgAtAFYAOwBJAEYAKABWADwAPQBWACkAewBSAFYAOwB9AEkARgAoAFYAPQA9ADEAJgAmAFYAPAA9AFYAKQB7AFIATQAoAFYALABWACwAVgBNACgAVgApACkAOwB9AEkARgAoAFYAPQA9AFYAKQB7AFIAVgBNACgAVgApADsAfQBFAEwASQBGACgAVgA8AFYAKQB7AFIAVgBNACgAVgAuAHMAdQBiAFYAaQBuAGcAKABWACwAVgApACkAOwB9AEUATAB7AFYAWwBdAFYAPQBOAFYAWwBwAGEAZABzAF0AOwBWAFsAXQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBbAGkAXQA9AFYAWwBpACUAcABhAGQATABlAG4AXQA7AH0AUgBWAE0AKABOAE0AKABWACkAKQA7AH1zcQB+AD8AAA0nAAANGwAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBQwogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgaW50IHBhZHMgPSBzaXplIC0gc3RyLmxlbmd0aCgpOwogICAgICAgIGlmIChwYWRzIDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsgICAgICAgICB9CiAgICAgICAgaWYgKHBhZHMgPiBQQURfTElNSVQpIHsKICAgICAgICAgICAgcmV0dXJuIGxlZnRQYWQoc3RyLCBzaXplLCBTdHJpbmcudmFsdWVPZihwYWRDaGFyKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYWRkaW5nKHBhZHMsIHBhZENoYXIpLmNvbmNhdChzdHIpOwogICAgdXEAfgBEAAAASgBJAEYAKABWAD0APQBOAFUAKQB7AFIATgBVADsAfQBJAFYAPQBWAC0AVgBNACgAKQA7AEkARgAoAFYAPAA9AFYAKQB7AFIAVgA7AH0ASQBGACgAVgA+AFYAKQB7AFIATQAoAFYALABWACwAVgBNACgAVgApACkAOwB9AFIATQAoAFYALABWACkALgBNACgAVgApADtzcQB+AD8AAA1dAAANQAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQDYQogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGlzRW1wdHkocGFkU3RyKSkgewogICAgICAgICAgICBwYWRTdHIgPSAiICI7CiAgICAgICAgfQogICAgICAgIGludCBwYWRMZW4gPSBwYWRTdHIubGVuZ3RoKCk7CiAgICAgICAgaW50IHN0ckxlbiA9IHN0ci5sZW5ndGgoKTsKICAgICAgICBpbnQgcGFkcyA9IHNpemUgLSBzdHJMZW47CiAgICAgICAgaWYgKHBhZHMgPD0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyOyAgICAgICAgIH0KICAgICAgICBpZiAocGFkTGVuID09IDEgJiYgcGFkcyA8PSBQQURfTElNSVQpIHsKICAgICAgICAgICAgcmV0dXJuIGxlZnRQYWQoc3RyLCBzaXplLCBwYWRTdHIuY2hhckF0KDApKTsKICAgICAgICB9CgogICAgICAgIGlmIChwYWRzID09IHBhZExlbikgewogICAgICAgICAgICByZXR1cm4gcGFkU3RyLmNvbmNhdChzdHIpOwogICAgICAgIH0gZWxzZSBpZiAocGFkcyA8IHBhZExlbikgewogICAgICAgICAgICByZXR1cm4gcGFkU3RyLnN1YnN0cmluZygwLCBwYWRzKS5jb25jYXQoc3RyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjaGFyW10gcGFkZGluZyA9IG5ldyBjaGFyW3BhZHNdOwogICAgICAgICAgICBjaGFyW10gcGFkQ2hhcnMgPSBwYWRTdHIudG9DaGFyQXJyYXkoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwYWRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHBhZGRpbmdbaV0gPSBwYWRDaGFyc1tpICUgcGFkTGVuXTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZyhwYWRkaW5nKS5jb25jYXQoc3RyKTsKICAgICAgICB9CiAgICB1cQB+AEQAAADeAEkARgAoAFYAPQA9AE4AVQApAHsAUgBOAFUAOwB9AEkARgAoAE0AKABWACkAKQB7AFYAPQAjACMAOwB9AEkAVgA9AFYATQAoACkAOwBJAFYAPQBWAE0AKAApADsASQBWAD0AVgAtAFYAOwBJAEYAKABWADwAPQBWACkAewBSAFYAOwB9AEkARgAoAFYAPQA9ADEAJgAmAFYAPAA9AFYAKQB7AFIATQAoAFYALABWACwAVgBNACgAVgApACkAOwB9AEkARgAoAFYAPQA9AFYAKQB7AFIAVgBNACgAVgApADsAfQBFAEwASQBGACgAVgA8AFYAKQB7AFIAVgAuAHMAdQBiAFYAaQBuAGcAKABWACwAVgApAC4ATQAoAFYAKQA7AH0ARQBMAHsAVgBbAF0AVgA9AE4AVgBbAHAAYQBkAHMAXQA7AFYAWwBdAFYAPQBWAE0AKAApADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBWAFsAaQBdAD0AVgBbAGkAJQBwAGEAZABMAGUAbgBdADsAfQBSAE4ATQAoAFYAKQAuAE0AKABWACkAOwB9c3EAfgA/AAANrAAADaAAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0AUcKICAgICAgICBpZiAoc3RyID09IG51bGwgfHwgc2l6ZSA8PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBzdHI7CiAgICAgICAgfQogICAgICAgIGludCBzdHJMZW4gPSBzdHIubGVuZ3RoKCk7CiAgICAgICAgaW50IHBhZHMgPSBzaXplIC0gc3RyTGVuOwogICAgICAgIGlmIChwYWRzIDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CiAgICAgICAgc3RyID0gbGVmdFBhZChzdHIsIHN0ckxlbiArIHBhZHMgLyAyLCBwYWRDaGFyKTsKICAgICAgICBzdHIgPSByaWdodFBhZChzdHIsIHNpemUsIHBhZENoYXIpOwogICAgICAgIHJldHVybiBzdHI7CiAgICB1cQB+AEQAAABQAEkARgAoAFYAPQA9AE4AVQB8AHwAVgA8AD0AVgApAHsAUgBWADsAfQBJAFYAPQBWAE0AKAApADsASQBWAD0AVgAtAFYAOwBJAEYAKABWADwAPQBWACkAewBSAFYAOwB9AFYAPQBNACgAVgAsAFYATABlAG4AKwBWAC8AVgAsAFYAKQA7AFYAPQBNACgAVgAsAFYALABWACkAOwBSAFYAO3NxAH4APwAADdcAAA3IAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAGICiAgICAgICAgaWYgKHN0ciA9PSBudWxsIHx8IHNpemUgPD0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICBpZiAoaXNFbXB0eShwYWRTdHIpKSB7CiAgICAgICAgICAgIHBhZFN0ciA9ICIgIjsKICAgICAgICB9CiAgICAgICAgaW50IHN0ckxlbiA9IHN0ci5sZW5ndGgoKTsKICAgICAgICBpbnQgcGFkcyA9IHNpemUgLSBzdHJMZW47CiAgICAgICAgaWYgKHBhZHMgPD0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICBzdHIgPSBsZWZ0UGFkKHN0ciwgc3RyTGVuICsgcGFkcyAvIDIsIHBhZFN0cik7CiAgICAgICAgc3RyID0gcmlnaHRQYWQoc3RyLCBzaXplLCBwYWRTdHIpOwogICAgICAgIHJldHVybiBzdHI7CiAgICB1cQB+AEQAAABfAEkARgAoAFYAPQA9AE4AVQB8AHwAVgA8AD0AVgApAHsAUgBWADsAfQBJAEYAKABNACgAVgApACkAewBWAD0AIwAjADsAfQBJAFYAPQBWAE0AKAApADsASQBWAD0AVgAtAFYAOwBJAEYAKABWADwAPQBWACkAewBSAFYAOwB9AFYAPQBNACgAVgAsAFYATABlAG4AKwBWAC8AVgAsAFYAKQA7AFYAPQBNACgAVgAsAFYALABWACkAOwBSAFYAO3NxAH4APwAADiIAAA4ZAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAEXCiAgICAgICAgaW50IHN0ckxlbjsKICAgICAgICBpZiAoc3RyID09IG51bGwgfHwgKHN0ckxlbiA9IHN0ci5sZW5ndGgoKSkgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1ZmZlcihzdHJMZW4pCiAgICAgICAgICAgIC5hcHBlbmQoQ2hhcmFjdGVyLnRvVGl0bGVDYXNlKHN0ci5jaGFyQXQoMCkpKQogICAgICAgICAgICAuYXBwZW5kKHN0ci5zdWJzdHJpbmcoMSkpCiAgICAgICAgICAgIC50b1N0cmluZygpOwogICAgdXEAfgBEAAAASQBJAFYAOwBJAEYAKABWAD0APQBOAFUAfAB8ACgAVgBMAGUAbgA9AFYATQAoACkAKQA9AD0AVgApAHsAUgBWADsAfQBSAE4ATQAoAFYAKQAuAE0AKABWAE0AKABWAE0AKABWACkAKQApAC4ATQAoAFYALgBzAHUAYgBWAGkAbgBnACgAVgApACkALgBNACgAKQA7c3EAfgA/AAAOTgAADkUAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0ARcKICAgICAgICBpbnQgc3RyTGVuOwogICAgICAgIGlmIChzdHIgPT0gbnVsbCB8fCAoc3RyTGVuID0gc3RyLmxlbmd0aCgpKSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBzdHI7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgU3RyaW5nQnVmZmVyKHN0ckxlbikKICAgICAgICAgICAgLmFwcGVuZChDaGFyYWN0ZXIudG9Mb3dlckNhc2Uoc3RyLmNoYXJBdCgwKSkpCiAgICAgICAgICAgIC5hcHBlbmQoc3RyLnN1YnN0cmluZygxKSkKICAgICAgICAgICAgLnRvU3RyaW5nKCk7CiAgICB1cQB+AEQAAABJAEkAVgA7AEkARgAoAFYAPQA9AE4AVQB8AHwAKABWAEwAZQBuAD0AVgBNACgAKQApAD0APQBWACkAewBSAFYAOwB9AFIATgBNACgAVgApAC4ATQAoAFYATQAoAFYATQAoAFYAKQApACkALgBNACgAVgAuAHMAdQBiAFYAaQBuAGcAKABWACkAKQAuAE0AKAApADtzcQB+AD8AAA6MAAAOeAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQCjQogICAgICAgIGludCBzdHJMZW47CiAgICAgICAgaWYgKHN0ciA9PSBudWxsIHx8IChzdHJMZW4gPSBzdHIubGVuZ3RoKCkpID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICB9CiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWZmZXIoc3RyTGVuKTsKCiAgICAgICAgY2hhciBjaCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdHJMZW47IGkrKykgewogICAgICAgICAgICBjaCA9IHN0ci5jaGFyQXQoaSk7CiAgICAgICAgICAgIGlmIChDaGFyYWN0ZXIuaXNVcHBlckNhc2UoY2gpKSB7CiAgICAgICAgICAgICAgICBjaCA9IENoYXJhY3Rlci50b0xvd2VyQ2FzZShjaCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQ2hhcmFjdGVyLmlzVGl0bGVDYXNlKGNoKSkgewogICAgICAgICAgICAgICAgY2ggPSBDaGFyYWN0ZXIudG9Mb3dlckNhc2UoY2gpOwogICAgICAgICAgICB9IGVsc2UgaWYgKENoYXJhY3Rlci5pc0xvd2VyQ2FzZShjaCkpIHsKICAgICAgICAgICAgICAgIGNoID0gQ2hhcmFjdGVyLnRvVXBwZXJDYXNlKGNoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidWZmZXIuYXBwZW5kKGNoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJ1ZmZlci50b1N0cmluZygpOwogICAgdXEAfgBEAAAAmwBJAFYAOwBJAEYAKABWAD0APQBOAFUAfAB8ACgAVgBMAGUAbgA9AFYATQAoACkAKQA9AD0AVgApAHsAUgBWADsAfQBNAFYAPQBOAE0AKABWACkAOwBWAGEAcgBWAD0AVgA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgA9AFYALgBWAGEAcgBBAHQAKABWACkAOwBJAEYAKABWAE0AKABWACkAKQB7AFYAPQBWAE0AKABWACkAOwB9AEUATABJAEYAKABWAE0AKABWACkAKQB7AFYAPQBWAE0AKABWACkAOwB9AEUATABJAEYAKABWAE0AKABWACkAKQB7AFYAPQBWAE0AKABWACkAOwB9AFYATQAoAFYAKQA7AH0AUgBWAE0AKAApADtzcQB+AD8AAA6uAAAOowAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBCQogICAgICAgIGlmIChpc0VtcHR5KHN0cikgfHwgaXNFbXB0eShzdWIpKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICBpbnQgY291bnQgPSAwOwogICAgICAgIGludCBpZHggPSAwOwogICAgICAgIHdoaWxlICgoaWR4ID0gc3RyLmluZGV4T2Yoc3ViLCBpZHgpKSAhPSAtMSkgewogICAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgICBpZHggKz0gc3ViLmxlbmd0aCgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY291bnQ7CiAgICB1cQB+AEQAAABAAEkARgAoAE0AKABWACkAfAB8AE0AKABWACkAKQB7AFIAVgA7AH0ASQBWAD0AVgA7AEkAVgA9AFYAOwBXACgAKABWAD0AVgBNACgAVgAsAFYAKQApACEAPQAtAFYAKQB7AFYAKwArADsAVgArAD0AVgBNACgAKQA7AH0AUgBWADtzcQB+AD8AAA7PAAAOxAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBEwogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGludCBzeiA9IHN0ci5sZW5ndGgoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN6OyBpKyspIHsKICAgICAgICAgICAgaWYgKENoYXJhY3Rlci5pc0xldHRlcihzdHIuY2hhckF0KGkpKSA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgdXEAfgBEAAAASwBJAEYAKABWAD0APQBOAFUAKQB7AFIARgA7AH0ASQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAVgAuAFYAcwBMAGUAdAB0AGUAcgAoAFYATQAoAFYAKQApAD0APQBGACkAewBSAEYAOwB9AH0AUgBUAEUAO3NxAH4APwAADvEAAA7mAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAEvCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaW50IHN6ID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3o7IGkrKykgewogICAgICAgICAgICBpZiAoKENoYXJhY3Rlci5pc0xldHRlcihzdHIuY2hhckF0KGkpKSA9PSBmYWxzZSkgJiYgKHN0ci5jaGFyQXQoaSkgIT0gJyAnKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgdXEAfgBEAAAAWgBJAEYAKABWAD0APQBOAFUAKQB7AFIARgA7AH0ASQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAKABWAC4AVgBzAEwAZQB0AHQAZQByACgAVgBNACgAVgApACkAPQA9AEYAKQAmACYAKABWAE0AKABWACkAIQA9ACcAJwApACkAewBSAEYAOwB9AH0AUgBUAEUAO3NxAH4APwAADxIAAA8HAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAEaCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaW50IHN6ID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3o7IGkrKykgewogICAgICAgICAgICBpZiAoQ2hhcmFjdGVyLmlzTGV0dGVyT3JEaWdpdChzdHIuY2hhckF0KGkpKSA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgdXEAfgBEAAAAUgBJAEYAKABWAD0APQBOAFUAKQB7AFIARgA7AH0ASQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAVgAuAFYAcwBMAGUAdAB0AGUAcgBPAHIARABWAGcAVgB0ACgAVgBNACgAVgApACkAPQA9AEYAKQB7AFIARgA7AH0AfQBSAFQARQA7c3EAfgA/AAAPNAAADykAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0ATYKICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpbnQgc3ogPSBzdHIubGVuZ3RoKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzejsgaSsrKSB7CiAgICAgICAgICAgIGlmICgoQ2hhcmFjdGVyLmlzTGV0dGVyT3JEaWdpdChzdHIuY2hhckF0KGkpKSA9PSBmYWxzZSkgJiYgKHN0ci5jaGFyQXQoaSkgIT0gJyAnKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgdXEAfgBEAAAAYQBJAEYAKABWAD0APQBOAFUAKQB7AFIARgA7AH0ASQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAKABWAC4AVgBzAEwAZQB0AHQAZQByAE8AcgBEAFYAZwBWAHQAKABWAE0AKABWACkAKQA9AD0ARgApACYAJgAoAFYATQAoAFYAKQAhAD0AJwAnACkAKQB7AFIARgA7AH0AfQBSAFQARQA7c3EAfgA/AAAPWgAAD08AAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0ARsKICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpbnQgc3ogPSBzdHIubGVuZ3RoKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzejsgaSsrKSB7CiAgICAgICAgICAgIGlmIChDaGFyVXRpbHMuaXNBc2NpaVByaW50YWJsZShzdHIuY2hhckF0KGkpKSA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgdXEAfgBEAAAAUwBJAEYAKABWAD0APQBOAFUAKQB7AFIARgA7AH0ASQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAVgBmACgAVgAuAFYAcwBBAHMAYwBWAFYAUAByAFYAbgB0AGEAYgBsAGUAKABWAE0AKABWACkAKQA9AD0ARgApAHsAUgBGADsAfQB9AFIAVABFADtzcQB+AD8AAA98AAAPcQAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBEgogICAgICAgIGlmIChzdHIgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGludCBzeiA9IHN0ci5sZW5ndGgoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN6OyBpKyspIHsKICAgICAgICAgICAgaWYgKENoYXJhY3Rlci5pc0RpZ2l0KHN0ci5jaGFyQXQoaSkpID09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB1cQB+AEQAAABKAEkARgAoAFYAPQA9AE4AVQApAHsAUgBGADsAfQBJAFYAPQBWAE0AKAApADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBWAGYAKABWAC4AVgBzAEQAVgBnAFYAdAAoAFYATQAoAFYAKQApAD0APQBGACkAewBSAEYAOwB9AH0AUgBUAEUAO3NxAH4APwAAD6AAAA+VAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAEuCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaW50IHN6ID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3o7IGkrKykgewogICAgICAgICAgICBpZiAoKENoYXJhY3Rlci5pc0RpZ2l0KHN0ci5jaGFyQXQoaSkpID09IGZhbHNlKSAmJiAoc3RyLmNoYXJBdChpKSAhPSAnICcpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB1cQB+AEQAAABZAEkARgAoAFYAPQA9AE4AVQApAHsAUgBGADsAfQBJAFYAPQBWAE0AKAApADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBWAGYAKAAoAFYALgBWAHMARABWAGcAVgB0ACgAVgBNACgAVgApACkAPQA9AEYAKQAmACYAKABWAE0AKABWACkAIQA9ACcAJwApACkAewBSAEYAOwB9AH0AUgBUAEUAO3NxAH4APwAAD8AAAA+1AAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAEZCiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaW50IHN6ID0gc3RyLmxlbmd0aCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3o7IGkrKykgewogICAgICAgICAgICBpZiAoKENoYXJhY3Rlci5pc1doaXRlc3BhY2Uoc3RyLmNoYXJBdChpKSkgPT0gZmFsc2UpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB1cQB+AEQAAABRAEkARgAoAFYAPQA9AE4AVQApAHsAUgBGADsAfQBJAFYAPQBWAE0AKAApADsARgBPACgAVgBuAHQAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBWAGYAKAAoAFYALgBWAHMAVwBoAFYAdABlAHMAcABhAGMAZQAoAFYATQAoAFYAKQApAD0APQBGACkAKQB7AFIARgA7AH0AfQBSAFQARQA7c3EAfgA/AAAQewAAEGEAAAAFcQB+ACpzcQB+AAUAAAAAdwQAAAAKeHB0A4YKICAgICAgICBpZiAoc3RyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChtYXhXaWR0aCA8IDQpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiTWluaW11bSBhYmJyZXZpYXRpb24gd2lkdGggaXMgNCIpOwogICAgICAgIH0KICAgICAgICBpZiAoc3RyLmxlbmd0aCgpIDw9IG1heFdpZHRoKSB7CiAgICAgICAgICAgIHJldHVybiBzdHI7CiAgICAgICAgfQogICAgICAgIGlmIChvZmZzZXQgPiBzdHIubGVuZ3RoKCkpIHsKICAgICAgICAgICAgb2Zmc2V0ID0gc3RyLmxlbmd0aCgpOwogICAgICAgIH0KICAgICAgICBpZiAoKHN0ci5sZW5ndGgoKSAtIG9mZnNldCkgPCAobWF4V2lkdGggLSAzKSkgewogICAgICAgICAgICBvZmZzZXQgPSBzdHIubGVuZ3RoKCkgLSAobWF4V2lkdGggLSAzKTsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZnNldCA8PSA0KSB7CiAgICAgICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIG1heFdpZHRoIC0gMykgKyAiLi4uIjsKICAgICAgICB9CiAgICAgICAgaWYgKG1heFdpZHRoIDwgNykgewogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJNaW5pbXVtIGFiYnJldmlhdGlvbiB3aWR0aCB3aXRoIG9mZnNldCBpcyA3Iik7CiAgICAgICAgfQogICAgICAgIGlmICgob2Zmc2V0ICsgKG1heFdpZHRoIC0gMykpIDwgc3RyLmxlbmd0aCgpKSB7CiAgICAgICAgICAgIHJldHVybiAiLi4uIiArIGFiYnJldmlhdGUoc3RyLnN1YnN0cmluZyhvZmZzZXQpLCBtYXhXaWR0aCAtIDMpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gIi4uLiIgKyBzdHIuc3Vic3RyaW5nKHN0ci5sZW5ndGgoKSAtIChtYXhXaWR0aCAtIDMpKTsKICAgIHVxAH4ARAAAANwASQBGACgAVgA9AD0ATgBVACkAewBSAE4AVQA7AH0ASQBGACgAVgA8AFYAKQB7AFQASABOAE0AKAAjACMAKQA7AH0ASQBGACgAVgBNACgAKQA8AD0AVgApAHsAUgBWADsAfQBJAEYAKABWAD4AVgBNACgAKQApAHsAVgA9AFYATQAoACkAOwB9AEkARgAoACgAVgBNACgAKQAtAFYAKQA8ACgAVgAtAFYAKQApAHsAVgA9AFYATQAoACkALQAoAFYALQBWACkAOwB9AEkARgAoAFYAPAA9AFYAKQB7AFIAVgAuAHMAdQBiAFYAaQBuAGcAKABWACwAVgAtAFYAKQArACMAIwA7AH0ASQBGACgAVgA8AFYAKQB7AFQASABOAE0AKAAjACMAKQA7AH0ASQBGACgAKABWACsAKABWAC0AVgApACkAPABWAE0AKAApACkAewBSACMAIwArAE0AKABWAC4AcwB1AGIAVgBpAG4AZwAoAFYAKQAsAFYALQBWACkAOwB9AFIAIwAjACsAVgAuAHMAdQBiAFYAaQBuAGcAKABWAE0AKAApAC0AKABWAC0AVgApACkAO3NxAH4APwAAEM4AABC9AAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAGsCiAgICAgICAgaWYgKHN0cjEgPT0gc3RyMikgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGlmIChzdHIxID09IG51bGwgfHwgc3RyMiA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICBpbnQgaTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3RyMS5sZW5ndGgoKSAmJiBpIDwgc3RyMi5sZW5ndGgoKTsgKytpKSB7CiAgICAgICAgICAgIGlmIChzdHIxLmNoYXJBdChpKSAhPSBzdHIyLmNoYXJBdChpKSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGkgPCBzdHIyLmxlbmd0aCgpIHx8IGkgPCBzdHIxLmxlbmd0aCgpKSB7CiAgICAgICAgICAgIHJldHVybiBpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gLTE7CiAgICB1cQB+AEQAAABzAEkARgAoAFYAPQA9AFYAKQB7AFIALQBWADsAfQBJAEYAKABWAD0APQBOAFUAfAB8AFYAPQA9AE4AVQApAHsAUgBWADsAfQBWAG4AdABWADsARgBPACgAVgA9AFYAOwBWADwAVgBNACgAKQAmACYAVgA8AFYATQAoACkAOwArACsAVgApAHsAVgBmACgAVgBNACgAVgApACEAPQBWAE0AKABWACkAKQB7AFYAOwB9AH0AVgBmACgAVgA8AFYATQAoACkAfAB8AFYAPABWAE0AKAApACkAewBSAFYAOwB9AFIALQBWADtzcQB+AD8AABEnAAAQ7wAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQGGAogICAgICAgIGlmIChzdHJzID09IG51bGwgfHwgc3Rycy5sZW5ndGggPD0gMSkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGJvb2xlYW4gYW55U3RyaW5nTnVsbCA9IGZhbHNlOwogICAgICAgIGJvb2xlYW4gYWxsU3RyaW5nc051bGwgPSB0cnVlOwogICAgICAgIGludCBhcnJheUxlbiA9IHN0cnMubGVuZ3RoOwogICAgICAgIGludCBzaG9ydGVzdFN0ckxlbiA9IEludGVnZXIuTUFYX1ZBTFVFOwogICAgICAgIGludCBsb25nZXN0U3RyTGVuID0gMDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheUxlbjsgaSsrKSB7CiAgICAgICAgICAgIGlmIChzdHJzW2ldID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGFueVN0cmluZ051bGwgPSB0cnVlOwogICAgICAgICAgICAgICAgc2hvcnRlc3RTdHJMZW4gPSAwOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYWxsU3RyaW5nc051bGwgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHNob3J0ZXN0U3RyTGVuID0gTWF0aC5taW4oc3Ryc1tpXS5sZW5ndGgoKSwgc2hvcnRlc3RTdHJMZW4pOwogICAgICAgICAgICAgICAgbG9uZ2VzdFN0ckxlbiA9IE1hdGgubWF4KHN0cnNbaV0ubGVuZ3RoKCksIGxvbmdlc3RTdHJMZW4pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChhbGxTdHJpbmdzTnVsbCB8fCAobG9uZ2VzdFN0ckxlbiA9PSAwICYmICFhbnlTdHJpbmdOdWxsKSkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzaG9ydGVzdFN0ckxlbiA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgICAgICAgICBpbnQgZmlyc3REaWZmID0gLTE7CiAgICAgICAgZm9yIChpbnQgc3RyaW5nUG9zID0gMDsgc3RyaW5nUG9zIDwgc2hvcnRlc3RTdHJMZW47IHN0cmluZ1BvcysrKSB7CiAgICAgICAgICAgIGNoYXIgY29tcGFyaXNvbkNoYXIgPSBzdHJzWzBdLmNoYXJBdChzdHJpbmdQb3MpOwogICAgICAgICAgICBmb3IgKGludCBhcnJheVBvcyA9IDE7IGFycmF5UG9zIDwgYXJyYXlMZW47IGFycmF5UG9zKyspIHsKICAgICAgICAgICAgICAgIGlmIChzdHJzW2FycmF5UG9zXS5jaGFyQXQoc3RyaW5nUG9zKSAhPSBjb21wYXJpc29uQ2hhcikgewogICAgICAgICAgICAgICAgICAgIGZpcnN0RGlmZiA9IHN0cmluZ1BvczsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZmlyc3REaWZmICE9IC0xKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGZpcnN0RGlmZiA9PSAtMSAmJiBzaG9ydGVzdFN0ckxlbiAhPSBsb25nZXN0U3RyTGVuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG9ydGVzdFN0ckxlbjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZpcnN0RGlmZjsKICAgIHVxAH4ARAAAATkASQBGACgAVgA9AD0ATgBVAHwAfABWAC4AbABlAG4AZwB0AGgAPAA9AFYAKQB7AFIALQBWADsAfQBCAE8AVgA9AEYAOwBCAE8AVgA9AFQARQA7AEkAVgA9AFYAOwBJAFYAPQBWADsASQBWAD0AVgA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsASQBGACgAVgBbAGkAXQA9AD0ATgBVACkAewBWAD0AVABFADsAVgA9AFYAOwB9AEUATAB7AFYAPQBGADsAVgA9AFYATQAoAFYAWwBpAF0ALgBNACgAKQAsAFYAKQA7AFYAPQBWAE0AKABWAFsAaQBdAC4ATQAoACkALABWACkAOwB9AH0ASQBGACgAYQBsAGwAUwB0AHIAaQBuAGcAcwBOAHUAbABsAHwAfAAoAFYAPQA9ADAAJgAmACEAVgApACkAewBSAC0AVgA7AH0ASQBGACgAVgA9AD0AVgApAHsAUgBWADsAfQBJAFYAPQAtAFYAOwBGAE8AKABJAFYAPQBWADsAVgA8AFYAOwBWACsAKwApAHsAQwBIAFYAPQBWAFsAMABdAC4ATQAoAFYAKQA7AEYATwAoAEkAVgA9AFYAOwBWADwAVgA7AFYAKwArACkAewBJAEYAKABWAFsAYQByAHIAYQB5AFAAbwBzAF0ALgBNACgAVgApACEAPQBWACkAewBWAD0AVgA7AFYAOwB9AH0ASQBGACgAVgAhAD0ALQBWACkAewBWADsAfQB9AEkARgAoAFYAPQA9AC0AMQAmACYAVgAhAD0AVgApAHsAUgBWADsAfQBSAFYAO3NxAH4APwAAEVwAABFKAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdAHuCiAgICAgICAgaWYgKHN0cnMgPT0gbnVsbCB8fCBzdHJzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWTsKICAgICAgICB9CiAgICAgICAgaW50IHNtYWxsZXN0SW5kZXhPZkRpZmYgPSBpbmRleE9mRGlmZmVyZW5jZShzdHJzKTsKICAgICAgICBpZiAoc21hbGxlc3RJbmRleE9mRGlmZiA9PSAtMSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3Ryc1swXSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHN0cnNbMF07CiAgICAgICAgfSBlbHNlIGlmIChzbWFsbGVzdEluZGV4T2ZEaWZmID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJzWzBdLnN1YnN0cmluZygwLCBzbWFsbGVzdEluZGV4T2ZEaWZmKTsKICAgICAgICB9CiAgICB1cQB+AEQAAABlAEkARgAoAFYAPQA9AE4AVQB8AHwAVgAuAGwAZQBuAGcAdABoAD0APQBWACkAewBSAFYAOwB9AEkAVgA9AE0AKABWACkAOwBJAEYAKABWAD0APQAtAFYAKQB7AEkARgAoAFYAWwAwAF0APQA9AE4AVQApAHsAUgBWADsAfQBSAFYAWwAwAF0AOwB9AEUATABJAEYAKABWAD0APQBWACkAewBSAFYAOwB9AEUATAB7AFIAVgBbAFYAXQAuAE0AKABWACwAVgApADsAfXNxAH4APwAAEc0AABGCAAAABXEAfgAqc3EAfgAFAAAAAHcEAAAACnhwdARACiAgICAgICAgaWYgKHMgPT0gbnVsbCB8fCB0ID09IG51bGwpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiU3RyaW5ncyBtdXN0IG5vdCBiZSBudWxsIik7CiAgICAgICAgfQoKICAgICAgICAKCiAgICAgICAgaW50IG4gPSBzLmxlbmd0aCgpOyAgICAgICAgIGludCBtID0gdC5sZW5ndGgoKTsgCiAgICAgICAgaWYgKG4gPT0gMCkgewogICAgICAgICAgICByZXR1cm4gbTsKICAgICAgICB9IGVsc2UgaWYgKG0gPT0gMCkgewogICAgICAgICAgICByZXR1cm4gbjsKICAgICAgICB9CgogICAgICAgIGlmIChuID4gbSkgewogICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgdG1wID0gczsKICAgICAgICAgICAgcyA9IHQ7CiAgICAgICAgICAgIHQgPSB0bXA7CiAgICAgICAgICAgIG4gPSBtOwogICAgICAgICAgICBtID0gdC5sZW5ndGgoKTsKICAgICAgICB9CgogICAgICAgIGludCBwW10gPSBuZXcgaW50W24rMV07ICAgICAgICAgaW50IGRbXSA9IG5ldyBpbnRbbisxXTsgICAgICAgICBpbnQgX2RbXTsgCiAgICAgICAgICAgICAgICBpbnQgaTsgICAgICAgICBpbnQgajsgCiAgICAgICAgY2hhciB0X2o7IAogICAgICAgIGludCBjb3N0OyAKICAgICAgICBmb3IgKGkgPSAwOyBpPD1uOyBpKyspIHsKICAgICAgICAgICAgcFtpXSA9IGk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGogPSAxOyBqPD1tOyBqKyspIHsKICAgICAgICAgICAgdF9qID0gdC5jaGFyQXQoai0xKTsKICAgICAgICAgICAgZFswXSA9IGo7CgogICAgICAgICAgICBmb3IgKGk9MTsgaTw9bjsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb3N0ID0gcy5jaGFyQXQoaS0xKT09dF9qID8gMCA6IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZFtpXSA9IE1hdGgubWluKE1hdGgubWluKGRbaS0xXSsxLCBwW2ldKzEpLCAgcFtpLTFdK2Nvc3QpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBfZCA9IHA7CiAgICAgICAgICAgIHAgPSBkOwogICAgICAgICAgICBkID0gX2Q7CiAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBbbl07CiAgICB1cQB+AEQAAAFgAEkARgAoAFYAPQA9AE4AVQB8AHwAVgA9AD0ATgBVACkAewBUAEgATgBNACgAIwAjACkAOwB9AGkAVgBWAFYAPQBWAC4AbABlAFYAZwBWAGgAKAApADsAaQBWAFYAVgA9AFYALgBsAGUAVgBnAFYAaAAoACkAOwBJAEYAKABWAD0APQBWACkAewBSAFYAOwB9AEUATABJAEYAKABWAD0APQBWACkAewByAGUAdAB1AHIAVgBWADsAfQBJAEYAKABWAD4AVgApAHsAUwBWAD0AVgA7AFYAPQBWADsAVgA9AFYAbQBwADsAVgA9AFYAOwBWAD0AVgAuAGwAZQBuAGcAVgBoACgAKQA7AH0AVgBWAFsAXQA9AFYAZQB3AFYAWwBWACsAMQBdADsAVgBWAFsAXQA9AFYAZQB3AFYAWwBWACsAMQBdADsAVgBfAFYAWwBdADsAVgBuAHQAVgA7AFYAbgB0AFYAOwBDAEgAVgA7AEkAVgA7AEYATwAoAFYAPQBWADsAVgA8AD0AVgA7AFYAKwArACkAewBWAFsAVgBdAD0AVgA7AH0ARgBPACgAVgA9AFYAOwBWADwAPQBWADsAVgArACsAKQB7AFYAPQBWAC4AYwBoAGEAcgBBAFYAKABWAC0AVgApADsAVgBbADAAXQA9AFYAOwBGAE8AKABWAD0AVgA7AFYAPAA9AFYAOwBWACsAKwApAHsAVgA9AFYATQAoAFYALQBWACkAPQA9AHQAXwBqAD8AVgA6AFYAOwBWAFsAVgBdAD0AVgAuAG0AVgBuACgAVgAuAG0AVgBuACgAVgBbAFYALQBWAF0AKwBWACwAVgBbAFYAXQArAFYAKQAsAFYAWwBWAC0AVgBdACsAVgApADsAfQBWAD0AVgA7AFYAPQBWADsAVgA9AF8AVgA7AH0AUgBWAFsAbgBdADtzcQB+AD8AABIsAAASJAAAAAVxAH4AKnNxAH4ABQAAAAB3BAAAAAp4cHQBDwogICAgICAgIGlmIChzdHIgPT0gbnVsbCB8fCBwcmVmaXggPT0gbnVsbCkgewogICAgICAg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KCFzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAgICAgcmV0dXJuIGRpci5kZWxldGUoKTsKdXEAfgBEAAAAWQBJAEYAKABWAE0AKAApACkAewBWAFsAXQBWAD0AVgBNACgAKQA7AEYATwAoAFYAbgB0AFYAPQBWADsAVgA8AGMAaABWAGwAZAByAGUAbgAuAGwAZQBuAGcAdABoADsAVgArACsAKQB7AEIATwBWAD0ATQAoAE4ATQAoAFYALABWAFsAaQBdACkAKQA7AEkARgAoACEAVgApAHsAUgBGADsAfQB9AH0AUgBWAE0AKAApADtzcQB+AD8AAAB+AAAAagAAAAVxAH4AMnNxAH4ABQAAAAB3BAAAAAp4cHQB1iAgCiAgICAKICAgICAgT3V0cHV0U3RyZWFtIG91dCA9IG51bGw7CiAgICAgIHRyeXsKICAgICAgICAgIG91dCA9IG5ldyBGaWxlT3V0cHV0U3RyZWFtKG91dEZpbGUpOwogICAgICAgICAgYnl0ZSBidWZbXT1uZXcgYnl0ZVsxMDI0XTsKICAgICAgICAgIGludCBsZW47CgkgIFN0cmluZyB0ZXN0ID0gImRvIHNvbWV0aGluZyI7CiAgICAgICAgICB3aGlsZSgobGVuPWlucHV0U3RyZWFtLnJlYWQoYnVmKSk+MCkKICAgICAgICAgICAgICBvdXQud3JpdGUoYnVmLDAsbGVuKTsKICAgICAgICAgIGlucHV0U3RyZWFtLmNsb3NlKCk7CiAgICAgIH0KICAgICAgY2F0Y2ggKElPRXhjZXB0aW9uIGUpe30KICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBvdXQuY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZXgpIHsKICAgICAgICAgICAgfQogICAgICAgCiAgICAgIH0KdXEAfgBEAAAAhQBPAHUAdABwAHUAdABTAHQAcgBlAGEAbQBWAD0ATgBVADsAVABSAHsAVgA9AE4ATQAoAFYARgBpAGwAZQApADsAVgBWAFsAXQA9AE4AVgBbAFYANABd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KTsKICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiB4KSB7CiAgICAgIHgucHJpbnRTdGFja1RyYWNlKCk7CiAgICB9CiAgICBTeXN0ZW0ub3V0LnByaW50bG4oImRvbmUuIik7CgogICAgIAogIHVxAH4ARAAAALsAVABSAHsASQBWAD0AVgA7AEkARgAoAFYAPgBWACkAewBWAD0AVgBNACgAVgBbADAAXQApADsAfQBUAGUAcwB0AEgAYQBuAGQAbABlAHIAVgA9AE4ATQAoACkAOwBWAC4AUAByAG8AYwBlAHMAcwBvAHIAVgA9AE4AVgBNACgAVgApADsAYgBsAGEAYgBsAGEAYgBsAGEAVABTAGUAcgB2AGUAcgBTAG8AYwBrAGUAdABWAD0ATgBNACgAVgApADsAVABQAHIAbwB0AG8AYwBvAGwARgBhAGMAdABvAHIAeQBWAD0ATgBWAE0AKAApADsAVABTAGUAcgB2AGUAcgBWADsAVgA9AE4ATQAoAFYALABWACwAVgApADsAVgBNACgAIwAjACsAVgArACMAIwApADsAVgBNACgAKQA7AH0AQwBBACgARQBWAGMAZQBwAHQAaQBvAG4AVgApAHsAVgBNACgAKQA7AH0AVgBNACgAIwAjACkAO3h4dAAMdGVzdC1zYW1wbGVz